"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkarcgis_starter"] = self["webpackChunkarcgis_starter"] || []).push([["vendors-node_modules_arcgis_core_layers_graphics_controllers_I3SOnDemandController_js-node_mo-d72b53"],{

/***/ "./node_modules/@arcgis/core/layers/graphics/controllers/I3SOnDemandController.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/graphics/controllers/I3SOnDemandController.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ te)\n/* harmony export */ });\n/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ \"./node_modules/@arcgis/core/chunks/tslib.es6.js\");\n/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/Accessor.js */ \"./node_modules/@arcgis/core/core/Accessor.js\");\n/* harmony import */ var _core_Handles_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Handles.js */ \"./node_modules/@arcgis/core/core/Handles.js\");\n/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/has.js */ \"./node_modules/@arcgis/core/core/has.js\");\n/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/Logger.js */ \"./node_modules/@arcgis/core/core/Logger.js\");\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/PooledArray.js */ \"./node_modules/@arcgis/core/core/PooledArray.js\");\n/* harmony import */ var _core_Promise_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/Promise.js */ \"./node_modules/@arcgis/core/core/Promise.js\");\n/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ \"./node_modules/@arcgis/core/core/promiseUtils.js\");\n/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../core/reactiveUtils.js */ \"./node_modules/@arcgis/core/core/reactiveUtils.js\");\n/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\");\n/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../core/accessorSupport/ensureType.js */ \"./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\");\n/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ \"./node_modules/@arcgis/core/core/arrayUtils.js\");\n/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js\");\n/* harmony import */ var _geometry_projection_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../geometry/projection.js */ \"./node_modules/@arcgis/core/geometry/projection.js\");\n/* harmony import */ var _geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../geometry/support/aaBoundingRect.js */ \"./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js\");\n/* harmony import */ var _dehydratedFeatures_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../dehydratedFeatures.js */ \"./node_modules/@arcgis/core/layers/graphics/dehydratedFeatures.js\");\n/* harmony import */ var _support_PromiseQueue_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../support/PromiseQueue.js */ \"./node_modules/@arcgis/core/layers/support/PromiseQueue.js\");\n/* harmony import */ var _views_ViewingMode_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../views/ViewingMode.js */ \"./node_modules/@arcgis/core/views/ViewingMode.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SFrameTask_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SFrameTask.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SFrameTask.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SIndex_js__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SIndex.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SIndex.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SLodHandling_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SLodHandling.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SLodHandling.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SNode.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SNodeLoader_js__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SNodeLoader.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNodeLoader.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SStreamDataController_js__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SStreamDataController.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SStreamDataController.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SUtil_js__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SUtil.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SUtil.js\");\n/* harmony import */ var _views_3d_layers_i3s_I3SViewportQueries_js__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../../../views/3d/layers/i3s/I3SViewportQueries.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SViewportQueries.js\");\n/* harmony import */ var _views_3d_layers_support_I3SLayerView_js__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../../../views/3d/layers/support/I3SLayerView.js */ \"./node_modules/@arcgis/core/views/3d/layers/support/I3SLayerView.js\");\n/* harmony import */ var _views_3d_support_extentUtils_js__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../../../views/3d/support/extentUtils.js */ \"./node_modules/@arcgis/core/views/3d/support/extentUtils.js\");\n/* harmony import */ var _views_3d_support_index_js__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../../../views/3d/support/index.js */ \"./node_modules/@arcgis/core/views/3d/support/index.js\");\n/* harmony import */ var _views_support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../../../views/support/layerViewUtils.js */ \"./node_modules/@arcgis/core/views/support/layerViewUtils.js\");\n/* harmony import */ var _views_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../../../views/support/Scheduler.js */ \"./node_modules/@arcgis/core/views/support/Scheduler.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nconst j=\"esri.layers.graphics.controllers.I3SOnDemandController\",Q=_core_Logger_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getLogger(j),T=100,E=2,H=1e4,R=1e-4,k=1.2,B=500,z=1.5;let K=class extends((0,_core_Promise_js__WEBPACK_IMPORTED_MODULE_7__.EsriPromiseMixin)(_core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])){get isMeshPyramid(){return\"mesh-pyramids\"===this.layer.profile||\"MeshPyramid\"===this.layer.store?.lodType}get isGraphics3D(){return\"points\"===this.layer.profile}get useMaximumNumberOfFeatures(){return!this.isMeshPyramid&&((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this.layer.priority)||\"High\"===this.layer.priority)}get indexStreamController(){const e=this.layerView.view.resourceController.createStreamDataRequester(_views_3d_support_index_js__WEBPACK_IMPORTED_MODULE_29__.ClientType.I3S_INDEX);return new _views_3d_layers_i3s_I3SStreamDataController_js__WEBPACK_IMPORTED_MODULE_24__.I3SStreamDataController(e,this.layer.apiKey)}get dataStreamController(){const e=this.layerView.view.resourceController.createStreamDataRequester(_views_3d_support_index_js__WEBPACK_IMPORTED_MODULE_29__.ClientType.I3S_DATA);return new _views_3d_layers_i3s_I3SStreamDataController_js__WEBPACK_IMPORTED_MODULE_24__.I3SStreamDataController(e,this.layer.apiKey)}get crsVertex(){return (0,_views_3d_layers_i3s_I3SUtil_js__WEBPACK_IMPORTED_MODULE_25__.getVertexCrs)(this.layer)}get crsIndex(){return (0,_views_3d_layers_i3s_I3SUtil_js__WEBPACK_IMPORTED_MODULE_25__.getIndexCrs)(this.layer)}get layer(){return this.layerView.i3slayer}get running(){return this.updating}get rootNodeVisible(){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)){const e=this._index.rootNode;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(e))return this._updateViewData(),this._index.isNodeVisible(e.index)}return!0}get index(){return this._index}constructor(e){super(e),this.screenSizeFactor=0,this.featureTarget=5e4,this.fixedFeatureTarget=!1,this.updating=!0,this.updatingProgress=1,this.leavesReached=!1,this.scaleVisibilityEnabled=!0,this._featureLOD=1,this._stableFeatureLOD=!1,this._isIdle=!1,this._cameraDirty=!0,this._invisibleDirty=!1,this._idleStateCallbacks=null,this._newLoadingNodes=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"]({deallocator:null}),this._loadedNodeScales=new Map,this._modificationsNodeFilteringArray=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"],this._downloadingCount=0,this._loadingNodes=new Map,this._updatingNodes=new Map,this._progressMaxNumNodes=1,this._requiredAttributes=new Array,this._requiredAttributesDirty=!0,this._updatesDisabled=!1,this.disableIDBCache=!1,this._disableMemCache=!1,this._restartNodeLoading=!1,this._fields=null,this._attributeStorageInfo=null,this._handles=new _core_Handles_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"],this._idleQueue=new _support_PromiseQueue_js__WEBPACK_IMPORTED_MODULE_17__.PromiseQueue,this._elevationUpdateNodes=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"]({deallocator:null}),this._errorCount=0}initialize(){const{layerView:e,layer:t}=this;this._disableMemCache=!e.loadCachedGPUData||!e.addCachedGPUData,this._lodHandling=new _views_3d_layers_i3s_I3SLodHandling_js__WEBPACK_IMPORTED_MODULE_21__[\"default\"](e),this._defaultGeometrySchema=t.store.defaultGeometrySchema,this.disableIDBCache=(0,_core_has_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(\"disable-feature:idb-cache\"),\"fields\"in t&&(this._fields=t.fields,this._attributeStorageInfo=t.attributeStorageInfo),this.addResolvingPromise(Promise.all([t.indexInfo,t.when(),e.when()]).then((([i])=>{if(this.destroyed||!e||e.destroyed||!i)return;const{view:s}=e,{resourceController:r}=s;this._setClippingArea(s.clippingArea),this.addHandles([(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>s?.pointsOfInterest?.focus?.renderLocation),(e=>this._pointOfInterestChanged(e)),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.initial),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>r.memoryController.memoryFactor),(()=>this._setCameraDirty()),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.sync),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>e.suspended),(e=>{const t=e?()=>this._updateViewData():()=>this._updateIdleState(!0),i=e?()=>{}:()=>this._updateIdleState(!1);!e&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.invalidateAllElevationRanges(),this._idleStateCallbacks?(e&&this.cancelNodeLoading(),this.restartNodeLoading(),this._idleStateCallbacks.idleBegin=t,this._idleStateCallbacks.idleEnd=i):this._idleStateCallbacks=r.scheduler.registerIdleStateCallbacks(t,i)}),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.initial),(0,_views_3d_layers_i3s_I3SFrameTask_js__WEBPACK_IMPORTED_MODULE_19__.addCallback)(e.view.resourceController.scheduler,this),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>e.uncompressedTextureDownsamplingEnabled),(()=>this.restartNodeLoading())),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>[this.featureTarget,this.fixedFeatureTarget]),(()=>{this._setCameraDirty(),this._stableFeatureLOD=!1})),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>s.state?.contentCamera),(()=>this._setCameraDirty())),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>t.elevationInfo),(e=>this._elevationInfoChanged(e))),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>t.effectiveScaleRange),(()=>this._scaleBoundsChanged())),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>e.lodFactor),(()=>this._setCameraDirty())),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>e.availableFields),(()=>this._requiredFieldsChange())),(0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>e.holeFilling),(e=>(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&(this._index.holeFilling=e)))]),this._updateScaleHandles(),this._viewportQueries=new _views_3d_layers_i3s_I3SViewportQueries_js__WEBPACK_IMPORTED_MODULE_26__[\"default\"](this.crsIndex,s.renderCoordsHelper,s.state.contentCamera,!s.state.fixedContentCamera||this.isGraphics3D,this._clippingArea,this.isMeshPyramid?s.basemapTerrain:s.elevationProvider,(0,_views_ViewingMode_js__WEBPACK_IMPORTED_MODULE_18__.viewingModeFromString)(s.viewingMode),this.layer.elevationInfo,{progressiveLoadFactor:this._getProgressiveLoadFactor(),screenspaceErrorBias:this._lod,angleDependentLoD:this._lod<.5}),this._index=new _views_3d_layers_i3s_I3SIndex_js__WEBPACK_IMPORTED_MODULE_20__.I3SIndex(t,i,this.indexStreamController,this._viewportQueries,Q,e.holeFilling,(t=>e.isNodeLoaded(t)),(t=>e.isNodeReloading(t)),(e=>this._shouldLoadNode(e)),(e=>this._enableFromGPUCache(e,_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.NodeState.Leaf)),(e=>this._needsUpdate(e)),(()=>!this.indexStreamController.busy),(t=>e.computeVisibilityObb?e.computeVisibilityObb(t):null),e?.computeNodeFiltering?t=>e.computeNodeFiltering(t):void 0),this._index.updateElevationInfo(this.layer.elevationInfo,this.isMeshPyramid),this._index.imModificationsChanged(!!e.hasModifications),this._startNodeLoading()}))),this._tmpPoint=(0,_dehydratedFeatures_js__WEBPACK_IMPORTED_MODULE_16__.makeDehydratedPoint)(0,0,0,this.crsIndex)}updateNodeModificationStatus(e){const t=this._index,i=this.layerView;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(t)&&i?.updateNodeModificationStatus&&(this._modificationsNodeFilteringArray.clear(),e.forAll((e=>{const i=t.getNode(e);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(i)&&this._modificationsNodeFilteringArray.push(i)})),i.updateNodeModificationStatus(this._modificationsNodeFilteringArray),this._invisibleDirty=!0)}destroy(){this.cancelNodeLoading(),this._idleStateCallbacks&&(this._isIdle=!1,this._idleStateCallbacks.remove(),this._idleStateCallbacks=null),this._handles.destroy(),this._nodeLoader=null,W.prune(),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(X)&&(X.hide(),X=null)}_getRequiredAttributes(){if(null==this._attributeStorageInfo||!this._fields||!this.layerView.availableFields)return[];const e=this._attributeStorageInfo,t=this._fields,i=this.layer.objectIdField;return this.layerView.availableFields.map((i=>{const s=J(e,i),r=J(t,i);return s>=0&&r>=0?{index:s,name:t[r].name,field:t[r],attributeStorageInfo:e[s]}:null})).filter((e=>null!=e&&e.name!==i))}_requiredFieldsChange(){const e=this._getRequiredAttributes();$(this._requiredAttributes,e)||(this._requiredAttributes=e,this._requiredAttributesDirty=!1,this.restartNodeLoading())}requestUpdate(){this._requiredAttributesDirty=!0,this.restartNodeLoading()}_setClippingArea(e){const t=(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_15__.create)();(0,_views_3d_support_extentUtils_js__WEBPACK_IMPORTED_MODULE_28__.toBoundingRect)(e,t,this.layerView.view.renderSpatialReference)?this._clippingArea=t:this._clippingArea=null}_pointOfInterestChanged(e){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._viewportQueries)&&(this._viewportQueries.setPointOfInterest(e),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&(this._index.progressiveLoadPenalty=Y.distancePenalty*this._viewportQueries.distCameraToPOI(),this._index.requestUpdate()))}updateClippingArea(e){this._setClippingArea(e),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._viewportQueries)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&(this._viewportQueries.updateClippingArea(this._clippingArea),this._index.invalidateVisibilityCache()),this._setCameraDirty()}_setCameraDirty(){this._cameraDirty=!0,this._lodHandling.setLodGlobalDirty(),this._evaluateUpdating()}updateElevationChanged(e,t){const i=this._index;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(i)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(i.rootNode)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(t))return null;this.crsIndex.equals(t)||((0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_14__.projectBoundingRect)(e,t,Z,this.crsIndex),e=Z);const s=this._elevationUpdateNodes;return s.clear(),(0,_views_3d_layers_i3s_I3SUtil_js__WEBPACK_IMPORTED_MODULE_25__.findIntersectingNodes)(e,i.rootNode,i,(e=>s.push(e.index))),s.length&&(s.forAll((e=>i.updateElevationChanged(e))),this._setCameraDirty()),s}getParentIndex(e){return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)?this._index.getParentIndex(e):-1}removeAllGeometryObbs(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.removeAllGeometryObbs()}getRenderMbs(e){return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._viewportQueries)?this._viewportQueries.getRenderMbs(e):null}_elevationInfoChanged(e){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)||(this._index.updateElevationInfo(e,this.isMeshPyramid),this._setCameraDirty())}_updateScaleHandles(){const e=\"scale-bounds\";this._handles.remove(e),this._areScaleBoundsActive&&this._handles.add(this.layerView.view.basemapTerrain.on(\"scale-change\",(e=>this._scaleUpdateHandler(e))),e)}_scaleBoundsChanged(){this._areScaleBoundsActive||this._loadedNodeScales.clear(),this._updateScaleHandles(),this._setCameraDirty()}_scaleUpdateHandler(e){this._updateScaleInBoundingRect(e.extent,e.spatialReference),this._setCameraDirty()}_updateScaleInBoundingRect(e,t){const i=this._index;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(i))return;const s=i.rootNode;!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(s)&&(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_14__.projectBoundingRect)(e,t,Z,this.crsIndex)&&this._loadedNodeScales.forEach(((e,t)=>{const s=i.getNode(t);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(s)&&(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_15__.intersectsSphere)(Z,s.mbs)&&this._loadedNodeScales.set(t,this._computeScale(s))}))}restartNodeLoading(){this._restartNodeLoading=!0,this.cancelNodeLoading(),this._evaluateUpdating()}schedule(e,t){return this._idleQueue.push(e,t)}reschedule(e,t){return this._idleQueue.unshift(e,t)}get _isIntegratedMesh(){return\"integrated-mesh\"===this.layer.type}get _areScaleBoundsActive(){const{minScale:e,maxScale:t}=(0,_views_support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_30__.extractSafeScaleBounds)(this.layer);return this.scaleVisibilityEnabled&&(e>0||t>0)}get unloadedMemoryEstimate(){return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)||this.layerView.suspended?0:this._index.unloadedMemoryEstimate*this._lodDropFactor}get indexDepth(){return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)?this._index.maxLevel:0}set disableMemCache(e){this.layerView.loadCachedGPUData&&this.layerView.addCachedGPUData||(this._disableMemCache=!0),this._disableMemCache=e}runTask(e,t){return this.layerView.suspended?(this._updateViewData(),this._evaluateUpdating(),-1/0):!this.layerView.visible||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)?-1/0:(this._processWithErrorLogging(e,t),this._index.maxPriority)}_processWithErrorLogging(e,t){try{this._process(e,t)}catch(i){this._errorCount<50?Q.error(\"Error during processing: \"+i):50===this._errorCount&&Q.error(\"Too many errors for this layer. Further errors will not be displayed.\"),this._errorCount++}}_process(e,t){this._restartNodeLoading&&this._startNodeLoading(),null==this._nodeLoader||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)||(this._updateViewData(),this._invisibleDirty&&this._removeInvisibleNodes(e)&&(this._invisibleDirty=!1),this._isIntegratedMesh&&(e.enabled=!1),e.run((()=>this._processIndex(e))),this._updateFeatureLOD(),e.run((()=>this._processCache(e))),this._isIntegratedMesh&&(e.enabled=!0),e.run((()=>this._processNodes(e,t))),this._idleQueue.runTask(e),e.run((()=>this._prefetchIndex())),t.numIndexLoading+=this._index.indexLoading,t.numNodesLoading+=this._downloadingCount,e.run((()=>this._lodHandling.lodGlobalHandling(e))),this._evaluateUpdating())}_processIndex(e){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index))return!1;if(this._index.dirty){this._newLoadingNodes.clear(),this._index.update(Array.from(this._loadingNodes.keys()),e,(e=>this.updateNodeModificationStatus(e))),this._disableMemCache||(this._newLoadingNodes.pushArray(this._index.updates.add.data,this._index.updates.add.length),this._newLoadingNodes.pushArray(this._index.updates.missing.data,this._index.updates.missing.length));const t=this._index.featureEstimate.leavesReached;this._index.isLoading||t===this._get(\"leavesReached\")||this._set(\"leavesReached\",t)}return this._index.load()}_prefetchIndex(){return!((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)||this._loadingNodes.size>0||this._index.updates.add.length>0)&&this._index.prefetch()}_updateFeatureLOD(){if(!this.useMaximumNumberOfFeatures||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._viewportQueries))return;const e=!this._index.isLoading,t=this.featureTarget*this._baseLOD,i=this._index.featureEstimate;if(i.estimate=i.estimate||t/2,this._index.indexMissing>B){if(this._featureLOD<=R)return;this._featureLOD/=z,this._stableFeatureLOD=!1}else if(e&&i.estimate<t){if(i.leavesReached||this._featureLOD>=H||this._stableFeatureLOD)return;const e=Math.min(10,Math.max(t/i.estimate,1.001));this._featureLOD*=e;const s=this._lod,r=this._index.checkFeatureTarget(t,s);r!==s&&(this._featureLOD=r/this._baseLOD,this._stableFeatureLOD=!0)}else{if(!(i.estimate>t*k||e&&i.estimate>t))return;if(this._featureLOD<=R)return;this._featureLOD/=1+.25*(i.estimate/t-1),this._stableFeatureLOD=!1}this._featureLOD=Math.min(H,Math.max(R,this._featureLOD)),this._viewportQueries.updateScreenSpaceErrorBias(this._lod),this._index.requestUpdate()}_processCache(e){const t=this._index;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(t))return!1;for(;this._newLoadingNodes.length>0&&!e.done;){const i=this._newLoadingNodes.pop();for(let s=t.getParent(i);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(s)&&(!this.layerView.isNodeLoaded(s.index)&&this._isNodeInScaleBounds(s));s=t.getParent(s.index))if(this._enableFromGPUCache(s,_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.NodeState.Hole)){e.madeProgress();break}}return e.hasProgressed}_processNodes(e,t){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index))return!1;let i=(this._isIdle?T:E)-this._loadingNodes.size;const s=this._index.updates;for(s.cancel.forEach(this._cancelNode,this),s.cancel=[];s.remove.length>0&&!e.done;)this.layerView.removeNode(s.remove.pop()),e.madeProgress();for(;s.update.length>0&&!e.done;){const t=this._index.getNode(s.update.pop());(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(t)&&(this._updateLoadedNode(t),e.madeProgress())}for(;s.add.length>0&&!e.done&&i>0;){--i;const a=this._index.getNode(s.add.back());if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(a)||a.cacheState!==_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.CacheState.Cached&&!this._hasNodeLoadToken(t))break;s.add.pop(),this._loadNode(a),e.madeProgress()}return e.hasProgressed}_cancelAllNodes(){this._loadingNodes.forEach((e=>e.abort())),this._loadingNodes.clear(),this._updatingNodes.forEach((e=>e.abort())),this._updatingNodes.clear()}_cancelNode(e){const t=this._loadingNodes.get(e);t&&(t.abort(),this._loadingNodes.delete(e))}_hasNodeLoadToken(e){return!(!this._isIdle&&e.numNodesLoading+this._loadingNodes.size>=E)&&(this._downloadingCount<_views_3d_support_index_js__WEBPACK_IMPORTED_MODULE_29__.maxDownloadSlots&&!this.dataStreamController.busy)}_evaluateUpdating(){let e=!1,t=0;if(this.layerView.suspended)e=this._cameraDirty,t=e?0:1;else{const i=((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)?this._index.indexMissing:0)+3*((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)?this._index.updates.add.length:0)+2*this._loadingNodes.size;e=!!(i>0||this._updatingNodes.size>0||this._restartNodeLoading||this._cameraDirty||this._idleQueue.running||this._lodHandling&&this._lodHandling.requiresLODGlobalHandling||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.isPrefetching),0===i&&(this._progressMaxNumNodes=1),this._progressMaxNumNodes=Math.max(i,this._progressMaxNumNodes),t=1-i/this._progressMaxNumNodes}this.updating=e,this.updatingProgress=t}_updateViewData(){if(!this._cameraDirty||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._viewportQueries))return;const e=this.layerView.view,{contentCamera:t,fixedContentCamera:i}=e.state;this.screenSizeFactor=1/(t.perScreenPixelRatio/2),this._viewportQueries.updateCamera(t,!i||this.isGraphics3D),this._viewportQueries.setPointOfInterest(e.pointsOfInterest.focus.renderLocation),this._viewportQueries.updateScreenSpaceErrorBias(this._lod),this._index.invalidateVisibilityCache(),this._index.progressiveLoadPenalty=Y.distancePenalty*this._viewportQueries.distCameraToPOI(),this._index.requestUpdate(),this._stableFeatureLOD=!1,this._invisibleDirty=!0,this._cameraDirty=!1,this.notifyChange(\"rootNodeVisible\")}_getProgressiveLoadFactor(){return this.layerView.view.resourceController.memoryController.memoryFactor<1?1:this.layerView.progressiveLoadFactor}get _lod(){return this._featureLOD*this._baseLOD}get _baseLOD(){const e=this.layerView.lodFactor,t=this.layerView.view.resourceController.memoryController.memoryFactor;return this.fixedFeatureTarget?1:(e>0?e:1)*t}get _lodDropFactor(){if(this.fixedFeatureTarget)return 1;const e=this.layerView.view.resourceController.memoryController;return(Math.min(e.memoryFactor,.5)-e.minQuality)/(.5-e.minQuality)}isGeometryVisible(e){return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.isGeometryVisible(e.index)}updateVisibility(e){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.invalidateNodeVisibilityCache(e)}invalidateGeometryVisibility(e){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.invalidateGeometryVisibility(e)}invalidateVisibilityObbs(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.invalidateVisibilityObbs()}modificationsChanged(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.imModificationsChanged(!!this.layerView.hasModifications),this._invisibleDirty=!0}_shouldLoadNode(e){return!(!this._lodHandling.shouldLoadNode(e)||this._shouldDropNode(e))&&(!((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index)||!this._index.isGeometryVisible(e.index))&&this._isNodeInScaleBounds(e))}_shouldDropNode(e){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._viewportQueries))return!1;const t=this._lodDropFactor;if(t>=1||!this._lodHandling.hasNoVisibleChildren(e))return!1;return Math.abs(this._viewportQueries.calcCameraDistanceToCenter(e))-this._viewportQueries.minDistance>(this._viewportQueries.maxDistance-this._viewportQueries.minDistance)*t}_startNodeLoading(){this._restartNodeLoading=!1;const e=this._index;if(this._updatesDisabled||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(e)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._viewportQueries))return;this._updateViewData(),this._requiredAttributesDirty&&(this._requiredAttributes=this._getRequiredAttributes(),this._requiredAttributesDirty=!1);const t={textureEncodings:this.layerView.supportedTextureEncodings,uncompressedTextureDownsamplingEnabled:this.layerView.uncompressedTextureDownsamplingEnabled,textureUsageMask:this.layerView.rendererTextureUsage,loadFeatureData:this.useMaximumNumberOfFeatures};this._nodeLoader=new _views_3d_layers_i3s_I3SNodeLoader_js__WEBPACK_IMPORTED_MODULE_23__[\"default\"](this.layer,this.dataStreamController,Q,this._defaultGeometrySchema,this._requiredAttributes,t),e.requestUpdate(),this._lodHandling.startNodeLoading((e=>this._isNodeInScaleBounds(e)),((e,t)=>this._removeNodes(e,t,ee.fadeout)),e,{maxLodLevel:this._viewportQueries.maxLodLevel}),this._evaluateUpdating()}isNodeLoading(){return null!=this._nodeLoader&&null!=this._index}cancelNodeLoading(){this.isNodeLoading()&&(this.indexStreamController.cancelAll(),this.dataStreamController.cancelAll(),this._idleQueue.cancelAll(),this._cancelAllNodes(),this._nodeLoader=null,this._evaluateUpdating())}_removeInvisibleNodes(e){const t=this._index;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(t)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._viewportQueries))return!1;W.clear(),this.layerView.getLoadedNodeIndices(W);const i=0===this._viewportQueries.maxDistance,s=i?()=>!1:e=>this._shouldDropNode(e);return W.filterInPlace((e=>{const i=t.getNode(e);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(i)||!t.isGeometryVisible(e)||s(i)||!this._isNodeInScaleBounds(i)})),W.length>0&&this._lodHandling.setLodGlobalDirty(),this._removeNodes(W,e,ee.pop),!(i&&this._lodDropFactor<1)&&(0===W.length||(W.clear(),!1))}markNodeToRemove(e){W.push(e)}removeMarkedNodes(){this._removeNodes(W,_views_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_31__.noBudget,ee.pop)}_removeNodes(e,t,i){const s=e.length;if(0!==s&&!t.done){for((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.requestUpdate();e.length>0&&!t.done;){const s=e.pop(),r=this._index;i===ee.fadeout&&this.layerView.nodeFadeoutEnabled&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(r)&&r.isGeometryVisible(s)?this.layerView.fadeNode(s,_views_3d_layers_support_I3SLayerView_js__WEBPACK_IMPORTED_MODULE_27__.FadeDirection.FadeOut,!0):this.layerView.removeNode(s),t.madeProgress()}if(this._loadedNodeScales.size>0)for(let t=e.length;t<s;t++){const i=e.data[t];this._loadedNodeScales.delete(i)}}}_needsUpdate(e){if(!e.resources.hasFeatureData||this._updatingNodes.has(e.index))return!1;const t=this.layerView.getLoadedAttributes(e.index);return null!=t&&t!==this._requiredAttributes}_updateLoadedNode(e){const t=new AbortController;this._updatingNodes.set(e.index,t);($(this.layerView.getLoadedAttributes(e.index),this._requiredAttributes)?Promise.resolve(this.layerView.getAttributeData(e.index)):this._nodeLoader.loadAttributes(e,this._requiredAttributes,t.signal)).then((i=>this.schedule((()=>this.layerView.updateAttributes(e.index,{loadedAttributes:this._requiredAttributes,attributeData:i},t.signal)),t.signal))).catch((i=>{if(!(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.isAbortError)(i))return this.layerView.updateAttributes(e.index,{loadedAttributes:this._requiredAttributes,attributeData:{}},t.signal)})).catch((()=>{})).then((()=>{this._updatingNodes.delete(e.index),this._evaluateUpdating()})),this._evaluateUpdating()}_loadNode(e){if(this._loadingNodes.has(e.index))return void Q.error(\"already loading node \"+e.index);const t=new AbortController;this._loadingNodes.set(e.index,t),this._evaluateUpdating(),this._loadAndAddNode(e,t.signal).then((i=>{i&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._loadingNodes.get(e.index)===t&&(this._loadingNodes.delete(e.index),this._index.requestUpdate())})).catch((e=>{if(!(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.isAbortError)(e))throw e})).finally((()=>{this._loadingNodes.get(e.index)===t&&this._loadingNodes.delete(e.index),this._evaluateUpdating()}))}_loadAndAddNode(e,t){return e.cacheState===_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.CacheState.Uncached?this._loadUncached(e,t).then((()=>!1)):this._loadCached(e,t).then((t=>!t&&(e.cacheState=_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.CacheState.Uncached,!0))).catch((t=>!(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.isAbortError)(t)&&(e.cacheState=_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.CacheState.Uncached,!0)))}_enableFromGPUCache(e,t){if(this._disableMemCache||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(this._index))return!1;if(t===_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.NodeState.Hole&&!this._index.useNodeAsHole(e.index))return!0;const i=this._loadCachedGPUData(e);return!!i&&(this.layerView.addCachedGPUData(e,i,t),this._nodeAdded(),!0)}_loadCachedGPUData(e){const t=this.layerView.loadCachedGPUData(e);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(t)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(t.attributeInfo)&&$(t.attributeInfo.loadedAttributes,this._requiredAttributes)?t:(this.layerView.deleteCachedGPUData(t),null)}_nodeAdded(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.requestUpdate(),this._lodHandling.setLodGlobalDirty(),this._evaluateUpdating()}updateLoadStatus(e,t){const i=this._index;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(i)&&i.updateChildrenLoaded(e,t?1:-1)}_loadCached(e,t){if(this._enableFromGPUCache(e,_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.NodeState.Leaf))return Promise.resolve(!0);const i=this.layerView;return!this.disableIDBCache&&i.loadCachedNodeData&&i.addCachedNodeData?this.schedule((()=>i.loadCachedNodeData(e,t,((t,i)=>this._nodeLoader.loadTextures(e,t,i)))),t).then((s=>{if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isNone)(s))return!1;const a=this._requiredAttributes;return this.reschedule((()=>this._nodeLoader.loadAttributes(e,a,t)),t).then((r=>this.reschedule((()=>i.addCachedNodeData(e,s,{loadedAttributes:a,attributeData:r},t)),t))).then((()=>(this._nodeAdded(),!0)))})):Promise.resolve(!1)}_loadUncached(e,t){return this._downloadingCount++,this._nodeLoader.loadNodeData(e,t).catch((e=>{throw this._downloadingCount--,e})).then((i=>(this._downloadingCount--,this.schedule((()=>this.layerView.addNode(e,i,t)),t)))).then((()=>{this._nodeAdded(),e.cacheState=_views_3d_layers_i3s_I3SNode_js__WEBPACK_IMPORTED_MODULE_22__.CacheState.Cached})).catch((t=>{if(!(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.isAbortError)(t))throw Q.error(\"#loadNodeData()\",this.layer,`Failed to load node '${e.id}'`,t),e.failed=!0,(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.requestUpdate(),t}))}_updateIdleState(e){e!==this._isIdle&&(this._isIdle=e,this._evaluateUpdating(),e&&this._index&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.resetFailedNodes())}_getScale(e){if(this._loadedNodeScales.has(e.index))return this._loadedNodeScales.get(e.index);const t=this._computeScale(e);return this.layerView.isNodeLoaded(e.index)&&this._loadedNodeScales.set(e.index,t),t}_computeScale(e){this._tmpPoint.x=e.mbs[0],this._tmpPoint.y=e.mbs[1],this._tmpPoint.z=e.mbs[2];const t=e.mbs[3];return this.layerView.view.basemapTerrain.getSphereScale(this._tmpPoint,t)}_isNodeInScaleBounds(e){if(!this._areScaleBoundsActive)return!0;const t=this._getScale(e),{minScale:i,maxScale:s}=(0,_views_support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_30__.extractSafeScaleBounds)(this.layer);return (0,_views_support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_30__.scaleBoundsPredicate)(t,i,s)}updateStats(e){e.index=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)?this._index.size:0,this.isGraphics3D&&(e.detail=this._featureLOD,e.target=this.featureTarget*this._baseLOD),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.updateStats(e)}get test(){const e=this;return{index:this._index,set disableUpdates(t){e._updatesDisabled=t,t?e.cancelNodeLoading():e.requestUpdate()},set disableIDBCache(t){e.disableIDBCache=t},set ignoreServiceObb(t){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(e._index)&&(e._index.ignoreServiceObb=t)},shouldLoadNode:t=>e._shouldLoadNode(t)}}notifyLODUpdate(){this._lodHandling.setLodGlobalDirty(),this._evaluateUpdating(),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(this._index)&&this._index.requestUpdate()}geometryFilterChanged(e){const t=this._index;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(t)&&t.layerFilterChanged(e),this._setCameraDirty()}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"isMeshPyramid\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"isGraphics3D\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"useMaximumNumberOfFeatures\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"indexStreamController\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"dataStreamController\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"crsVertex\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"crsIndex\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],K.prototype,\"screenSizeFactor\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],K.prototype,\"featureTarget\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],K.prototype,\"fixedFeatureTarget\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],K.prototype,\"layerView\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],K.prototype,\"layer\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],K.prototype,\"updating\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"running\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],K.prototype,\"updatingProgress\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],K.prototype,\"leavesReached\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({constructOnly:!0})],K.prototype,\"scaleVisibilityEnabled\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0,dependsOn:[]})],K.prototype,\"rootNodeVisible\",null),K=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_13__.subclass)(j)],K);const W=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"]({deallocator:null});let X;function $(e,t){return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_5__.isSome)(e)&&e.length===t.length&&e.every((e=>J(t,e.name)>=0))}function J(e,t){const i=t.toLowerCase();for(let s=0;s<e.length;s++)if(e[s].name.toLowerCase()===i)return s;return-1}const Y={factorIM:.2,factor3dObject:.05,distancePenalty:10},Z=(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_15__.create)();var ee;!function(e){e[e.pop=0]=\"pop\",e[e.fadeout=1]=\"fadeout\"}(ee||(ee={}));const te=K;\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/layers/graphics/controllers/I3SOnDemandController.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/layers/support/featureQueryAll.js":
/*!*********************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/support/featureQueryAll.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"getMaxRecordCountFactor\": () => (/* binding */ u),\n/* harmony export */   \"getMaximumQuerySize\": () => (/* binding */ a),\n/* harmony export */   \"getMaximumRecordCount\": () => (/* binding */ o),\n/* harmony export */   \"queryAllJSON\": () => (/* binding */ t)\n/* harmony export */ });\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _rest_support_Query_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../rest/support/Query.js */ \"./node_modules/@arcgis/core/rest/support/Query.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nasync function t(r,t,o){t=t.clone(),r.capabilities.query.supportsMaxRecordCountFactor&&(t.maxRecordCountFactor=u(r));const i=a(r),n=r.capabilities.query.supportsPagination;t.start=0,t.num=i;let s=null;for(;;){const a=await r.source.queryFeaturesJSON(t,o);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s)?s=a:s.features=s.features.concat(a.features),s.exceededTransferLimit=a.exceededTransferLimit,!n||!a.exceededTransferLimit)break;t.start+=i}return s}function a(e){return u(e)*o(e)}function o(e){return e.capabilities.query.maxRecordCount||2e3}function u(e){return e.capabilities.query.supportsMaxRecordCountFactor?_rest_support_Query_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].MAX_MAX_RECORD_COUNT_FACTOR:1}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/layers/support/featureQueryAll.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/FeatureLayerView3D.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/FeatureLayerView3D.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ y)\n/* harmony export */ });\n/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ \"./node_modules/@arcgis/core/chunks/tslib.es6.js\");\n/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/Error.js */ \"./node_modules/@arcgis/core/core/Error.js\");\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\");\n/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/accessorSupport/ensureType.js */ \"./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\");\n/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ \"./node_modules/@arcgis/core/core/arrayUtils.js\");\n/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js\");\n/* harmony import */ var _geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../geometry/projection.js */ \"./node_modules/@arcgis/core/geometry/projection.js\");\n/* harmony import */ var _layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../layers/support/layerUtils.js */ \"./node_modules/@arcgis/core/layers/support/layerUtils.js\");\n/* harmony import */ var _support_featureFlags_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../support/featureFlags.js */ \"./node_modules/@arcgis/core/support/featureFlags.js\");\n/* harmony import */ var _FeatureLayerViewBase3D_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./FeatureLayerViewBase3D.js */ \"./node_modules/@arcgis/core/views/3d/layers/FeatureLayerViewBase3D.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nlet l=class extends _FeatureLayerViewBase3D_js__WEBPACK_IMPORTED_MODULE_10__[\"default\"]{constructor(){super(...arguments),this.type=\"feature-3d\",this.direct3DObjectFeatureLayerDisplayEnabled=(0,_support_featureFlags_js__WEBPACK_IMPORTED_MODULE_9__.enableDirect3DObjectFeatureLayerDisplay)()}initialize(){const{layer:e,view:s}=this;(0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_8__.getEffectiveLayerCapabilities)(e)?.operations.supportsQuery||this.addResolvingPromise(Promise.reject(new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](\"featurelayerview:query-not-supported\",\"layer view requires a layer with query capability\",{layer:e}))),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(e.infoFor3D)&&(this.direct3DObjectFeatureLayerDisplayEnabled?this._set(\"suspendResumeExtentMode\",\"computed\"):this.addResolvingPromise(Promise.reject(new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](\"featurelayerview3d:unsupported-geometry-type\",`Unsupported geometry type ${e.geometryType}`)))),\"mesh\"!==e.geometryType||(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.canProjectWithoutEngine)(e.spatialReference,s.spatialReference)||this.addResolvingPromise(Promise.reject(new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"](\"layerview:spatial-reference-incompatible\",\"The spatial references of the feature layer is incompatible with the spatial reference of the view\")))}get featureSpatialReference(){return this.view.featureTiles?.tilingScheme?.spatialReference}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.property)({constructOnly:!0})],l.prototype,\"direct3DObjectFeatureLayerDisplayEnabled\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.property)()],l.prototype,\"layer\",void 0),l=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.subclass)(\"esri.views.3d.layers.FeatureLayerView3D\")],l);const y=l;\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/FeatureLayerView3D.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SFrameTask.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SFrameTask.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"addCallback\": () => (/* binding */ l)\n/* harmony export */ });\n/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../chunks/tslib.es6.js */ \"./node_modules/@arcgis/core/chunks/tslib.es6.js\");\n/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/Accessor.js */ \"./node_modules/@arcgis/core/core/Accessor.js\");\n/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../core/arrayUtils.js */ \"./node_modules/@arcgis/core/core/arrayUtils.js\");\n/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../core/accessorSupport/decorators/property.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\");\n/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../core/accessorSupport/ensureType.js */ \"./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\");\n/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../core/accessorSupport/decorators/subclass.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js\");\n/* harmony import */ var _support_Scheduler_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../support/Scheduler.js */ \"./node_modules/@arcgis/core/views/support/Scheduler.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nlet i=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]{constructor(){super(),this.referenceCount=0,this.callbacks=new Array,this.runIndex=0}get running(){return this.callbacks.some((r=>r.running))}runTask(r){this._sort();const s=this.callbacks,t={numIndexLoading:0,numNodesLoading:0};for(let e=0;e<s.length&&!r.done;++e)s[e].priority=s[e].runTask(r,t),this.runIndex=e}_sort(){const r=this.callbacks;let s=r.length;for(let t=this.runIndex;t>0;t--){const e=r[t-1];let n=t;for(;n<r.length&&e.priority<=r[n].priority&&(n!==s||e.priority<r[n].priority);)r[n-1]=r[n],n++;r[n-1]=e,s=n-1}this.runIndex=0}add(r){this._sort(),r.priority=1/0,this.callbacks.unshift(r),this.notifyChange(\"running\")}remove(r){(0,_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_2__.removeUnordered)(this.callbacks,r),this.runIndex=this.callbacks.length,this._sort(),this.notifyChange(\"running\")}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.property)({readOnly:!0})],i.prototype,\"running\",null),i=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_5__.subclass)(\"esri.views.3d.layers.i3s.I3SFrameTask\")],i);class a{constructor(r,s){this.task=r,this.handle=s}}const c=new Map;function l(r,s){let t=c.get(r);if(null==t){const s=new i,e=r.registerTask(_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_6__.TaskPriority.I3S_CONTROLLER,s);t=new a(s,e),c.set(r,t)}return t.task.add(s),{remove:()=>{if(null==t)return;t.task.remove(s);t.task.callbacks.length>0||(c.delete(r),t.handle.remove(),t.task.destroy()),t=null}}}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SFrameTask.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SIndex.js":
/*!*******************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SIndex.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"I3SIndex\": () => (/* binding */ p),\n/* harmony export */   \"selectErrorMetric\": () => (/* binding */ E)\n/* harmony export */ });\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/PooledArray.js */ \"./node_modules/@arcgis/core/core/PooledArray.js\");\n/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../core/promiseUtils.js */ \"./node_modules/@arcgis/core/core/promiseUtils.js\");\n/* harmony import */ var _chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../chunks/vec3.js */ \"./node_modules/@arcgis/core/chunks/vec3.js\");\n/* harmony import */ var _chunks_vec4f64_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../chunks/vec4f64.js */ \"./node_modules/@arcgis/core/chunks/vec4f64.js\");\n/* harmony import */ var _I3SNode_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./I3SNode.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js\");\n/* harmony import */ var _I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./I3SUtil.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SUtil.js\");\n/* harmony import */ var _support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../support/orientedBoundingBox.js */ \"./node_modules/@arcgis/core/views/3d/support/orientedBoundingBox.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nclass b{constructor(e,t,i,s,n){this.childOffset=e,this.childCount=t,this.visibilityCache=i,this.ref=s,this.node=n,this.useAsHole=0,this.filterImpact=_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeFilterImpact.NotChecked}}class p{constructor(e,t,i,n,r,o,d,l,h,u,c,_,g,m){this._streamDataController=i,this._viewportQueries=n,this._logger=r,this.holeFilling=o,this._isLoaded=d,this._isReloading=l,this._isSelected=h,this._enable=u,this._needsUpdate=c,this._canRequest=_,this._computeVisibilityObb=g,this._computeNodeFiltering=m,this._dirty=!0,this._nodePages=[],this._nodeCount=0,this._nodesPerPage=0,this._rootIndex=0,this._lodMetric=_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.None,this._lodConversion=e=>e,this._urlPrefix=\"\",this._loading=new Set,this._failedNodes=new Set,this._failedPages=new Set,this._indexMissing=1,this._maxUnloadedPrio=Number.NEGATIVE_INFINITY,this._maxProcessingPrio=Number.POSITIVE_INFINITY,this._nodeTraversalState=new Map,this._version=I(0),this._visibilityCacheVersion=I(0),this._maxLevel=1,this._featureEstimate={estimate:0,leavesReached:!1},this._unloadedMemoryEstimate=0,this._missing=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({deallocator:null}),this._prefetch=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({deallocator:null}),this._updates=new N(this._missing),this._imModificationUncategorized=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({deallocator:null}),this.ignoreServiceObb=!1,this.progressiveLoadPenalty=0,this._pageQueue=[],this.needNodeElevationRange=!1,this.layerHasModifications=!1,this._layerHasFilter=!1,this._logLayer=e,e.serviceUpdateTimeStamp&&e.serviceUpdateTimeStamp.lastUpdate&&(this._lastUpdate=`${e.serviceUpdateTimeStamp.lastUpdate}`),this._maxLodLevel=this._viewportQueries?this._viewportQueries.maxLodLevel:1,this._init(t)}_init(e){if(\"page\"===e.type){switch(this._urlPrefix=e.urlPrefix,this._nodesPerPage=e.pageSize,this._rootIndex=e.rootIndex,e.lodMetric){case\"maxScreenThreshold\":this._lodMetric=_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.MaxScreenThreshold;break;case\"maxScreenThresholdSQ\":this._lodMetric=_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.MaxScreenThreshold,this._lodConversion=V}this._addPage(S(this._rootIndex,this._nodesPerPage),e.rootPage),this._updateParentsAndLevel()}else if(\"node\"===e.type){this._urlPrefix=e.urlPrefix,this._nodePages.push({nodes:[],children:[],parents:[]}),this._makeRefNode(new _I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeBase(e.rootNode.id,null),-1);const t=this._validateNode(e.rootNode.id,e.rootNode);t&&this._addNode(t,0)}}_loadPage(e){this._loading.add(e);const t=this._urlPrefix+e;this._streamDataController.request(t,\"json\").then((t=>{this._pageQueue.push({pageIndex:e,page:t})})).catch((t=>{this._loading.delete(e),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.isAbortError)(t)||(this._failedPages.add(e),this._logger.error(\"#loadPage()\",this._logLayer,`Error when loading page ${e}`,t))}))}_addQueuedPages(e){for(;this._pageQueue.length>0&&!e.done;){const{pageIndex:t,page:i}=this._pageQueue.shift();this._addPage(t,i),this._loading.delete(t),e.madeProgress()}this._updateParentsAndLevel()}_addPage(e,t){for(let r=this._nodePages.length;r<e;r++)this._nodePages[r]=null;const i=[],s=[],n=t.nodes.map(((t,n)=>{const a=i.length,d=t.children?t.children.length:0;s.push(-1);for(let e=0;e<d;e++)i.push(t.children[e]);const h=`${t.index}`,u=(0,_support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_7__.clone)(t.obb),c=(0,_chunks_vec4f64_js__WEBPACK_IMPORTED_MODULE_4__.b)([u.center[0],u.center[1],u.center[2],(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_3__.l)(u.halfSize)]),_=t.mesh&&t.mesh.attribute,g=t.mesh&&t.mesh.geometry,m=t.mesh&&t.mesh.material,f={hasSharedResource:!1,hasFeatureData:!!g,attributes:_&&null!=_.resource?`${_.resource}`:void 0,geometry:g&&null!=g.resource?`${g.resource}`:void 0,texture:m&&null!=m.resource?`${m.resource}`:void 0,geometryDefinition:g?g.definition:-1,materialDefinition:m?m.definition:-1},p=new _I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.Node(h,e*this._nodesPerPage+n,c,d,0,f,this._lastUpdate,this._lodMetric,this._lodConversion(t.lodThreshold),g?g.featureCount:null);return p.serviceObb=u,p.visibilityObb=this._computeVisibilityObb(p),p.vertexCount=g?g.vertexCount:0,new b(a,d,x(this._visibilityCacheVersion),null,p)}));this._nodePages[e]={nodes:n,children:i,parents:s},this._nodeCount+=n.length}_updateParentsAndLevel(){const t=new Array,i=(i,s,n)=>{const r=this._getPage(i);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(r)){const o=R(i,this._nodesPerPage);r.parents[o]=s;const a=r.nodes[o].node;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(a)&&(a.level=n,t.push(i))}};for(i(this._rootIndex,-1,0);t.length;){const s=t.pop(),n=this.getNode(s);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(n))for(let e=0;e<n.childCount;e++){i(this.getChildIndex(n.index,e),s,n.level+1),this._maxLevel=Math.max(this._maxLevel,n.level+1)}}}_getPage(e){return this._nodePages[S(e,this._nodesPerPage)]}_getNodeInternal(e){const i=this._getPage(e);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i)?null:i.nodes[R(e,this._nodesPerPage)]}_addNode(t,s){null!=t.children&&this.populateChildren(s,t.children);const n=this.getParent(s),r=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(n)?n.level+1:0;this._maxLevel=Math.max(this._maxLevel,t.children?r+1:r);const{lodMetric:a,maxError:d}=E(t.lodSelection),h=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.unwrap)(this._getNodeInternal(s));return h.node=new _I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.Node(t.id,s,(0,_chunks_vec4f64_js__WEBPACK_IMPORTED_MODULE_4__.b)(t.mbs),h.childCount,r,t.resources,t.version,a,d,t.numFeatures),t.obb&&(h.node.serviceObb=(0,_support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_7__.clone)(t.obb)),h.node.visibilityObb=this._computeVisibilityObb(h.node),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(h.ref)&&(null==h.ref.mbs&&(h.ref.mbs=t.mbs),h.node.renderMbs=h.ref.renderMbs,h.node.serviceObbInRenderSR=h.ref.serviceObbInRenderSR,h.ref.visibilityObb=h.node.visibilityObb),h.node}_makeRefNode(e,t){const i=this._nodePages[0];if(null==i)return-1;const s=i.nodes.length;return i.nodes.push(new b(0,0,x(this._visibilityCacheVersion),e,null)),this._nodeCount++,i.parents.push(t),(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateMbs)(e.renderMbs),(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateObb)(e.serviceObbInRenderSR),s}populateChildren(e,t){const s=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.unwrap)(this._getNodeInternal(e)),n=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.unwrap)(this._getPage(e));s.childOffset=n.children.length,s.childCount=t.length;for(let i=0;i<t.length;i++){const s=this._makeRefNode(t[i],e);n.children.push(s)}}getNode(t){const i=this._getNodeInternal(t);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)?i.node:null}getIndexById(t){let i;return this._forAllNodes(((s,n)=>{((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.node)&&s.node.id===t||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.ref)&&s.ref.id===t)&&(i=n)})),i}getNodeById(e){const t=this.getIndexById(e);return null!=t&&t>=0?this.getNode(t):null}getChildIndex(e,i){const s=this._getPage(e);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s))return-1;const n=s.nodes[R(e,this._nodesPerPage)];return s.children[n.childOffset+i]}getParentIndex(t){const i=this._getPage(t);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)?i.parents[R(t,this._nodesPerPage)]:-1}getParent(e){return(e=this.getParentIndex(e))>=0?this.getNode(e):null}isLeaf(t){const i=this._getNodeInternal(t);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&0===i.childCount}get rootNode(){return this.getNode(this._rootIndex)}get size(){return this._nodeCount}removeAllGeometryObbs(){this._forAllNodes((t=>{(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t.node)&&(t.node.geometryObb=null)}))}invalidateVisibilityCache(){this._visibilityCacheVersion=I(this._visibilityCacheVersion)}invalidateNodeVisibilityCache(t){const i=this._getNodeInternal(t);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&this.invalidateNodeVisibilityCacheInternal(i)}invalidateNodeVisibilityCacheInternal(e){e.visibilityCache=x(this._visibilityCacheVersion)}invalidateBoundingVolumeCache(t){const i=this._getNodeInternal(t);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&(P(i),this.invalidateNodeVisibilityCacheInternal(i))}updateElevationChanged(i){const s=this._getNodeInternal(i);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s))return;if(!this.needNodeElevationRange)return void this.invalidateBoundingVolumeCache(i);const n=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.node)?s.node:s.ref;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(n))return;const r=n.elevationRange;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(r)||(r.valid=!1)}invalidateGeometryVisibility(t){const i=this._getNodeInternal(t);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i.node)&&(i.node.geometryObb=null,(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateMbs)(i.node.renderMbs),(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateObb)(i.node.serviceObbInRenderSR))}invalidateVisibilityObbs(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(this.rootNode)||this.traverse(this.rootNode,(e=>(e.visibilityObb=this._computeVisibilityObb(e),e.geometryObb=null,!0)))}_updateElevationRange(i){const s=this._getNodeInternal(i);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s))return null;const n=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.node)?s.node:s.ref;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(n))return null;const r=n.elevationRange;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(r)&&r.valid)return r;const o=new _I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.ElevationRange;let a=!1;for(let e=0;e<s.childCount;e++){const s=this._updateElevationRange(this.getChildIndex(i,e));(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s)?a=!0:(o.min=Math.min(o.min,s.min),o.max=Math.max(o.max,s.max))}if(0===s.childCount||a&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.node)&&s.node.resources.geometry){const t=this._viewportQueries.getElevationRange(n);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t)&&(o.min=Math.min(o.min,t.min),o.max=Math.max(o.max,t.max))}return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(r)&&r.min===o.min&&r.max===o.max?(r.valid=!0,r):(o.valid=!0,n.elevationRange=o,this.invalidateBoundingVolumeCache(i),o)}isNodeVisible(i){const s=this._getNodeInternal(i);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.ref)&&!s.ref.mbs)return!0;if(this.needNodeElevationRange&&this._updateElevationRange(i),!w(s.visibilityCache,this._visibilityCacheVersion)){const i=s.node,n=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s.ref)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i.visibilityObb))?i:(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.ref)?s.ref:null;if(this._layerHasFilter&&this._computeNodeFiltering&&((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.ref))&&s.filterImpact===_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeFilterImpact.NotChecked){const t=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)?i.mbs:(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.ref)?s.ref.mbs:null;s.filterImpact=null!=t?this._computeNodeFiltering(t):_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeFilterImpact.Unmodified}const r=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&s.filterImpact===_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeFilterImpact.Culled,o=!((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&i.imModificationImpact===_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeIMModificationImpact.Culled)&&(!n||this._viewportQueries.isNodeVisible(n))&&!r;return s.visibilityCache=C(o,this._visibilityCacheVersion),o}return M(s.visibilityCache)}isGeometryVisible(t){if(!this.isNodeVisible(t))return!1;const i=this._getNodeInternal(t);return!((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i.node)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i.node.geometryObb)&&(!this.layerHasModifications||i.node.imModificationImpact!==_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeIMModificationImpact.NotChecked))||this._viewportQueries.isGeometryVisible(i.node)}_traverseCoverage(s,n,r,o,a){const d=this._getPage(s);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(d)||0===n.childCount)return;const l=n.childOffset+n.childCount,h=new Array;for(let t=n.childOffset;t<l;++t){const i=d.children[t],s=this._getNodeInternal(i);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.node)&&this.isGeometryVisible(i)&&h.push(s)}o/=h.length;for(const e of h){const t=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.unwrap)(e.node).index;this._isLoaded(t)||this._isReloading(t)?(a.delta=Math.max(a.delta,r),a.coverage+=o):this._traverseCoverage(t,e,r+1,o,a)}}useNodeAsHole(e){if(\"off\"===this.holeFilling)return!1;const i=this._getNodeInternal(e);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i))return!1;if(\"always\"===this.holeFilling)return!0;if(w(i.useAsHole,this._version))return M(i.useAsHole);const s={delta:0,coverage:0};this._traverseCoverage(e,i,0,1,s);const n=s.delta*s.coverage<=.5;return i.useAsHole=C(n,this._version),n}get maxLevel(){return this._maxLevel}get dirty(){return this._dirty}destroy(){this._updates.add.prune(),this._updates.update.prune()}requestUpdate(){this._dirty=!0,this._indexMissing=1,this._version=I(this._version)}imModificationsChanged(t){this.layerHasModifications=t,this._forAllNodes((({node:t})=>{(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t)&&(t.imModificationImpact=_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeIMModificationImpact.NotChecked,t.visibilityObb=this._computeVisibilityObb(t),t.hasModifications&&this.invalidateGeometryVisibility(t.index))})),this.invalidateVisibilityCache()}layerFilterChanged(t){this._layerHasFilter=t,this._forAllNodes((t=>{if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t)){t.filterImpact=_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeFilterImpact.NotChecked;const i=t.node;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)&&this.invalidateNodeVisibilityCache(i.index)}})),this.invalidateVisibilityCache()}update(s,n,r){if(!this._dirty)return;this._pageQueue.length>0&&this._addQueuedPages(n),this._maxUnloadedPrio=Number.NEGATIVE_INFINITY,this._maxProcessingPrio=Number.NEGATIVE_INFINITY,this._missing.clear(),this._prefetch.clear(),this._updates.reset(s),y.clear();let o=!0;const a=new O,d=new O,l=this._imModificationUncategorized;l.clear();const h=new Set,u=(u,_,g)=>{if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(_)){let e=this._entryPriority(u);e===1/0&&(e=this._entryPriority(g));const t=S(u,this._nodesPerPage);return y.set(t,Math.max(e,y.get(t)||0)),this._loading.has(t)||this._failedPages.has(t)||this._missing.push(t),void(this._maxProcessingPrio=Math.max(this._maxProcessingPrio,e))}const m=_.node;if(this._updateNodeFeatureEstimate(m,d),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(m)){const e=this._entryPriority(u);return this._loading.has(u)||this._failedNodes.has(u)||(this._missing.push(u),y.set(u,e)),void(this._maxProcessingPrio=Math.max(this._maxProcessingPrio,e))}const f=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.unwrap)(this._getPage(u));if(0===this._missing.length&&0===this._nodesPerPage)for(let t=0;t<_.childCount;t++){const i=f.children[_.childOffset+t],s=this._getNodeInternal(i);!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s)||s.node||this._loading.has(i)||this._failedNodes.has(i)||(y.set(i,this._entryPriority(i)),this._prefetch.push(i))}if(m.failed||!m.resources.hasFeatureData)return void(o&&_.childCount>0&&this._isSelected(m)&&(o=!1));if(h.add(m.id),this._isLoaded(u)){if(a.known+=m.memory,++a.knownNodes,this._isSelected(m)?_.childCount>0&&(o=!1):(a.unremoved+=m.memory,o=!1),this._needsUpdate(m)){const e=this._entryPriority(u);y.set(u,e),this._maxProcessingPrio=Math.max(this._maxProcessingPrio,e),this._updates.update.push(u)}return}if(m.memory&&(a.known+=m.memory,++a.knownNodes),!this._isSelected(m))return void(this._isReloading(u)&&this._updates.remove.push(u));if(_.childCount>0&&(o=!1),m.memory?(a.missing+=m.memory,a.known+=m.memory,++a.knownNodes):++a.missingNodes,s.includes(m.index))return this._maxProcessingPrio=Math.max(this._maxProcessingPrio,this._entryPriority(u)),void(this._updates.cancel=this._updates.cancel.filter((e=>e!==m.index)));if(!n.done&&this._enable(m))return void n.madeProgress();const v=this._entryPriority(u);y.set(u,v),this._maxProcessingPrio=Math.max(this._maxProcessingPrio,v),this._updates.add.push(u),this.layerHasModifications&&r&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(m)&&m.imModificationImpact===_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeIMModificationImpact.NotChecked&&l.push(u)};this.traverseVisible(u);const _=this._updates.add;_.length>0&&this.layerHasModifications&&(l.length>0&&r?.(l),_.filterInPlace((e=>{const i=this._getNodeInternal(e),s=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i.node)||i.node.imModificationImpact!==_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeIMModificationImpact.Culled;return s||this.invalidateNodeVisibilityCache(e),s}))),this._unloadedMemoryEstimate=a.missing-a.unremoved,a.knownNodes>3&&a.missingNodes>0&&(this._unloadedMemoryEstimate+=a.known/a.knownNodes*a.missingNodes),this._unloadedMemoryEstimate=.8*Math.max(0,this._unloadedMemoryEstimate),this._featureEstimate.estimate=this._computeFeatureEstimate(d),this._featureEstimate.leavesReached=o,this._missing.sort(((e,t)=>e-t)),this._missing.filterInPlace(((e,t)=>t<1||this._missing.data[t-1]!==e)),this._missing.sort(((e,t)=>y.get(e)-y.get(t))),this._missing.length>0&&(this._maxUnloadedPrio=y.get(this._missing.back()),this._prefetch.clear()),this._updates.add.filterInPlace((e=>y.get(e)>=this._maxUnloadedPrio)).sort(((e,t)=>y.get(e)-y.get(t))),this._updates.update.sort(((e,t)=>y.get(e)-y.get(t))),this._indexMissing=this._loading.size+this._missing.length,this._dirty=this._indexMissing>0,y.clear()}checkFeatureTarget(e,t){const i=this._viewportQueries.updateScreenSpaceErrorBias(t);let s=t,n=t,r=i,o=10;for(;o--;){const i=new O;this._updateFeatureEstimate(s,i);if(this._computeFeatureEstimate(i)<=e){if(s>=t||i.missingNodes>0||0===o)break;r=s,s=.5*(s+n)}else n=s,s=.5*(s+r)}return this._version=I(this._version),this._viewportQueries.updateScreenSpaceErrorBias(i),Math.min(t,s)}_updateFeatureEstimate(t,i){this._version=I(this._version),this._viewportQueries.updateScreenSpaceErrorBias(t),this.traverseVisible(((t,s)=>this._updateNodeFeatureEstimate((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s)?s.node:void 0,i)))}_updateNodeFeatureEstimate(i,s){if(!((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i)||i.failed||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i.numFeatures)))return this._isLoaded(i.index)?(s.known+=i.numFeatures,++s.knownNodes,void(this._isSelected(i)||(s.unremoved+=i.numFeatures))):void(this._isSelected(i)&&((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i.numFeatures)?(s.missing+=i.numFeatures,s.known+=i.numFeatures,++s.knownNodes):++s.missingNodes))}_computeFeatureEstimate(e){let t=e.known-e.unremoved;return e.knownNodes>3&&e.missingNodes>0&&(t+=e.known/e.knownNodes*e.missingNodes),Math.max(0,t)}load(){return this._load(this._missing)}prefetch(){return this._prefetch.sort(((e,t)=>y.get(e)-y.get(t))),this._load(this._prefetch)}_load(e){if(0===e.length||!this._canRequest())return!1;for(;e.length>0&&this._canRequest();)0===this._nodesPerPage?this._loadNode(e.pop()):this._loadPage(e.pop());return!0}get isLoading(){return this._indexMissing>0}get isPrefetching(){return this._prefetch.length>0}get indexLoading(){return this._loading.size}get indexMissing(){return this._indexMissing}get unloadedMemoryEstimate(){return this._unloadedMemoryEstimate}get updates(){return this._updates}get featureEstimate(){return this._featureEstimate}get maxPriority(){return Math.max(this._maxProcessingPrio,this._maxUnloadedPrio)}nodeTraversalState(e){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(e))return null;let i=this._nodeTraversalState.get(e.index);if(i&&w(i.version,this._version))return i;const s=this._viewportQueries.getLodLevel(e),n=this._viewportQueries.hasLOD(e);let r=!0;if(n){const t=this.getParentIndex(e.index);if(t>=0){const e=this._nodeTraversalState.get(t);r=!!e&&s>e.lodLevel}else r=s>0}else r=0===e.childCount;return i?(i.lodLevel=s,i.isChosen=r,i.version=C(!0,this._version),i):(i=new _I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeTraversalState(n,r,s,C(!0,this._version)),this._nodeTraversalState.set(e.index,i),i)}_loadNode(e){this._loading.add(e);const s=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.unwrap)(this._getNodeInternal(e)).ref;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s))return void this._failedNodes.add(e);const r=s.id,o=this._urlPrefix+r,a=()=>{this._loading.delete(e),0===this._missing.length&&0===this._loading.size&&this.requestUpdate()};this._streamDataController.request(o,\"json\").then((t=>{a();const i=this._validateNode(r,t);if(null==i)return;i.obb&&this.invalidateNodeVisibilityCache(e);const s=this._addNode(i,e);this.nodeTraversalState(s)}),(t=>{a(),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.isAbortError)(t)||(this._logger.error(\"#loadNode()\",this._logLayer,\"Error loading node: \"+o),this._failedNodes.add(e))}))}_validateNode(e,t){if(null==t||\"object\"!=typeof t||t.id!==e)return this._logger.error(\"#validateNode()\",this._logLayer,`Invalid node. Wrong type or wrong id \"${e}\"`),null;if(!Array.isArray(t.mbs))return this._logger.error(\"#validateNode()\",this._logLayer,`Invalid bounding volume on node ${e}.`),null;t.sharedResource&&\"./shared\"!==t.sharedResource.href&&\"./shared/\"!==t.sharedResource.href&&this._logger.warn(\"#validateNode()\",this._logLayer,`Invalid shared resource href on node \"${e}\"`),null==t.geometryData||Array.isArray(t.geometryData)&&1===t.geometryData.length&&\"./geometries/0\"===t.geometryData[0].href||this._logger.warn(\"#validateNode()\",this._logLayer,`Invalid geometry data on node \"${e}\"`),null==t.attributeData||Array.isArray(t.attributeData)&&!t.attributeData.some(((e,t)=>e.href!==`./attributes/f_${t}/0`))||this._logger.warn(\"#validateNode()\",this._logLayer,`Invalid attribute data on node \"${e}\"`),t.featureData&&t.featureData.length>1&&this._logger.warn(\"#validateNode()\",this._logLayer,`Node ${e} has ${t.featureData.length} bundles. Only the first bundle will be loaded.`);const i=t.hasOwnProperty(\"obb\")&&!this.ignoreServiceObb?t.obb:null,s=t.featureData&&1===t.featureData.length&&t.featureData[0].featureRange?t.featureData[0].featureRange[1]-t.featureData[0].featureRange[0]+1:void 0,n=t=>{if(null==t)return null;const i=t=>this._logger.error(\"#validateNode()\",this._logLayer,`Invalid node reference on node ${e}: ${t}`);if(\"number\"==typeof t.id)i(`id ${t.id} is a number instead of a string.`);else if(\"string\"!=typeof t.id||!Array.isArray(t.mbs))return i(\"Missing or invalid id.\"),null;if(!Array.isArray(t.mbs))return i(`Invalid bounding volume on reference ${t.id}.`),null;t.href&&t.href!==\"../\"+t.id&&this._logger.error(\"#validateNode()\",this._logLayer,`Invalid node href on node \"${e}\"`);const s=t.hasOwnProperty(\"obb\")&&!this.ignoreServiceObb?t.obb:null,n=new _I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.NodeBase(`${t.id}`,t.mbs);return n.serviceObb=s,n.visibilityObb=this._computeVisibilityObb(n),n},r=Array.isArray(t.children)?t.children.map(n).filter((e=>null!=e)):null;return{id:e,mbs:t.mbs,obb:i,children:r,resources:{hasFeatureData:t.featureData&&t.featureData.length>0,hasSharedResource:null!=t.sharedResource,attributes:t.attributeData?e:void 0,texture:t.textureData&&t.textureData.length>0?e:void 0,geometry:null!=t.geometryData?e:void 0},version:\"string\"==typeof t.version?t.version:null,lodSelection:Array.isArray(t.lodSelection)?t.lodSelection:null,numFeatures:s}}resetFailedNodes(){this._failedNodes.clear(),this._failedPages.clear(),this._forAllNodes((t=>{(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t.node)&&(t.node.failed=!1)}))}_entryPriority(i){const s=this._getNodeInternal(i),n=this.getParentIndex(i);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s)||n<0&&null==s.node)return n<0?1/0:this._entryPriority(n);let r=0;if(s.node&&n>=0){const e=this._nodeTraversalState.get(n);null!=e&&(r=e.lodLevel)}let o=this.progressiveLoadPenalty;for(let e=i;e>=0;e=this.getParentIndex(e))if(this._isLoaded(e)){o=0;break}const a=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.ref)?this._viewportQueries.distToPOI(s.ref):(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.node)?this._viewportQueries.distToPOI(s.node):0;return-a-r*(a+this.progressiveLoadPenalty)+o}traverseVisible(e){const i=this._getNodeInternal(this._rootIndex);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i)?e(this._rootIndex,null,null):this._traverseVisible(this._rootIndex,-1,i,e)}_traverseVisible(t,s,n,r){if(n.node&&0===n.childCount)return void(this.isGeometryVisible(t)&&r(t,n,s));if(!this.isNodeVisible(t))return;if(r(t,n,s),null==n.node)return;const o=this.nodeTraversalState(n.node);if(o?.nodeHasLOD&&o.lodLevel===this._maxLodLevel)return;const a=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.unwrap)(this._getPage(t));for(let i=0;i<n.childCount;i++){const s=a.children[n.childOffset+i],o=this._getNodeInternal(s);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(o)?this._traverseVisible(s,t,o,r):r(s,null,t)}}traverse(e,t){t(e)&&this.traverseChildren(e,t)}traverseChildren(t,i){const s=t.index,n=this._getNodeInternal(s);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(n)&&this._traverseChildren(s,n,i)}_traverseChildren(i,s,n){const r=this._getPage(i);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(r))return;const o=s.childOffset+s.childCount;for(let t=s.childOffset;t<o;++t){const i=r.children[t],s=this._getNodeInternal(i);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s.node)&&n(s.node)&&this._traverseChildren(i,s,n)}}updateChildrenLoaded(t,i){let s=this.getNode(t);for(;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s);)s.childrenLoaded+=i,s=this.getParent(s.index)}checkChildrenLoadedInvariant(){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(this.rootNode))return!0;const e=[],i=t=>{let s=this._isLoaded(t.index)||this._isReloading(t.index)?1:0;return this.traverseChildren(t,(e=>(s+=i(e),!1))),t.childrenLoaded!==s&&e.push(t.index),s};return i(this.rootNode),e.length&&this._logger.error(\"childrenLoaded invariant broken at following nodes: \"+e.join(\",\")),e.length>0}updateStats(e){if(this._updates.add.length>0&&(e.nodes+=\" + \"+this._updates.add.length),(this._indexMissing||this._prefetch.length>0)&&(e.index+=\" + \"+this._indexMissing||0),e.prio=this._maxProcessingPrio,this._featureEstimate.estimate){const t=this._featureEstimate.estimate-e.features;t>0?e.features+=\" + \"+t:t<0&&(e.features+=\" - \"+-t)}}updateElevationInfo(e,t){this.needNodeElevationRange=t&&!!e&&(\"relative-to-ground\"===e.mode||\"on-the-ground\"===e.mode),this._viewportQueries.updateElevationInfo(e),this.invalidateAllElevationRanges()}invalidateAllElevationRanges(){this._forAllNodes((t=>{P(t),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t.node)&&(t.node.elevationRange=null),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t.ref)&&(t.ref.elevationRange=null)}))}_forAllNodes(e){for(let t=0;t<this._nodePages.length;t++){const i=this._nodePages[t];if(i){const s=t*this._nodesPerPage;for(let t=0;t<i.nodes.length;t++)e(i.nodes[t],s+t)}}}get test(){return{addNode:(e,t)=>this._addNode(e,t)}}}const y=new Map;class N{constructor(e){this.missing=e,this.update=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({deallocator:null}),this.add=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({deallocator:null}),this.remove=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({deallocator:null}),this.cancel=[]}reset(e){this.add.clear(),this.update.clear(),this.cancel=e}}function P(t){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t.node)&&((0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateMbs)(t.node.renderMbs),(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateObb)(t.node.serviceObbInRenderSR)),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(t.ref)&&((0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateMbs)(t.ref.renderMbs),(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.invalidateObb)(t.ref.serviceObbInRenderSR))}function x(e){return (0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.addWraparound)(e,-2)}function I(e){return (0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_6__.addWraparound)(e,2)}function C(e,t){return t+(e?1:0)}function w(e,t){return(-2&e)===t}function M(e){return 1==(1&e)}function S(e,t){return 0===t?0:e/t|0}function R(e,t){return 0===t?e:e%t}const L=[[\"maxScreenThreshold\",_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.MaxScreenThreshold],[\"screenSpaceRelative\",_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.ScreenSpaceRelative],[\"removedFeatureDiameter\",_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.RemovedFeatureDiameter],[\"distanceRangeFromDefaultCamera\",_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.DistanceRangeFromDefaultCamera]];function E(e){if(e)for(let t=0;t<e.length;t++)for(const i of L)if(i[0]===e[t].metricType)return{lodMetric:i[1],maxError:e[t].maxError};return{lodMetric:_I3SNode_js__WEBPACK_IMPORTED_MODULE_5__.LodMetric.None,maxError:0}}class O{constructor(){this.known=0,this.knownNodes=0,this.missing=0,this.missingNodes=0,this.unremoved=0}}function V(e){return Math.sqrt(e*(4/Math.PI))}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SIndex.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SLodHandling.js":
/*!*************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SLodHandling.js ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ t)\n/* harmony export */ });\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/PooledArray.js */ \"./node_modules/@arcgis/core/core/PooledArray.js\");\n/* harmony import */ var _I3SNode_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./I3SNode.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js\");\n/* harmony import */ var _support_I3SLayerView_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../support/I3SLayerView.js */ \"./node_modules/@arcgis/core/views/3d/layers/support/I3SLayerView.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nclass t{constructor(e){this._layerView=e,this._lodGlobalDirty=!1}startNodeLoading(e,i,o,s){this._maxLodLevel=s.maxLodLevel,this._index=o,this._isNodeInScaleBounds=e,this._removeNodes=i}shouldLoadNode(i){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(i))return!1;const o=this._index.nodeTraversalState(i);return!!this._isChosenMaxLOD(o)||!!o.isChosen&&this._childrenRequireLoading(i)}setLodGlobalDirty(){this._lodGlobalDirty=!0}get requiresLODGlobalHandling(){return null!=this._index&&!0===this._lodGlobalDirty}lodGlobalHandling(e){if(!this.requiresLODGlobalHandling)return!1;this._lodGlobalDirty=!1;const i=this._layerView.view.resourceController.memoryController.usedMemory,o=Math.max(0,Math.floor(10*(i-1)));r.clear(),this._lodGlobalHandling(this._index.rootNode,o,!1,!!this._layerView.nodeCrossfadingEnabled);const s=r.length;this._removeNodes(r,e);const d=r.length<s;return 0!==r.length&&(this._lodGlobalDirty=!0),r.clear(),d}_lodGlobalHandling(o,t,l,n){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(o))return!1;const a=o.index,h=this._index,_=this._layerView,u=h.nodeTraversalState(o),c=this._isChosenMaxLOD(u),x=!o.resources.hasFeatureData;if(c&&x)return o.childrenLoaded>0&&this._removeChildrenRecursive(o),!0;const L=_.isNodeLoaded(a);if(n&&L&&c){const e=!l&&this.hasNoVisibleChildren(o);_.fadeNode(a,_support_I3SLayerView_js__WEBPACK_IMPORTED_MODULE_3__.FadeDirection.FadeIn,!e)}const N=L&&(!_.isNodeFullyFadedIn||_.isNodeFullyFadedIn(a));if(L&&(_.updateNodeState(a,c?_I3SNode_js__WEBPACK_IMPORTED_MODULE_2__.NodeState.Leaf:_I3SNode_js__WEBPACK_IMPORTED_MODULE_2__.NodeState.Hole),c))return N&&this._removeChildrenRecursive(o),N;const m=o.childCount>0;let y=m;if(m)for(let e=0;e<o.childCount;e++){const o=h.getChildIndex(a,e),s=h.getNode(o);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s)){!(!h.isGeometryVisible(o)||this._lodGlobalHandling(s,t,l||N,n))&&this._isNodeInScaleBounds(s)&&(y=!1)}else h.isNodeVisible(o)&&(y=!1)}const b=L&&!c&&(y||r.length<t);b&&r.push(a),!n||b||!L||l||y||_.fadeNode(a,_support_I3SLayerView_js__WEBPACK_IMPORTED_MODULE_3__.FadeDirection.FadeIn,!1);const f=!o.resources.hasFeatureData;return y||N&&!b||f}_removeChildrenRecursive(e){this._index.traverseChildren(e,(e=>((this._layerView.isNodeLoaded(e.index)||this._layerView.isNodeReloading(e.index))&&r.push(e.index),e.childrenLoaded>0)))}hasNoVisibleChildren(e){let i=!0;return this._index.traverseChildren(e,(e=>!(!i||!this._index.isNodeVisible(e.index))&&(this._layerView.isNodeLoaded(e.index)?(i=!1,!1):e.childrenLoaded>0))),i}_childrenRequireLoading(e){let i=!1,o=!0;return this._index.traverseChildren(e,(e=>{if(!o||!this._index.isNodeVisible(e.index))return!1;const s=this._index.nodeTraversalState(e);return this._isChosenMaxLOD(s)&&this._index.isGeometryVisible(e.index)&&(i=!0),this._layerView.isNodeLoaded(e.index)?(o=!1,!1):e.childrenLoaded>0})),o&&i}_isChosenMaxLOD(e){return e.isChosen&&(!e.nodeHasLOD||e.lodLevel===this._maxLodLevel)}}const r=new _core_PooledArray_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({deallocator:null});\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SLodHandling.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SMaterialUtil.js":
/*!**************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SMaterialUtil.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"configureMaterial\": () => (/* binding */ S),\n/* harmony export */   \"createTexture\": () => (/* binding */ C),\n/* harmony export */   \"defaultMaterial\": () => (/* binding */ F),\n/* harmony export */   \"getMaterialAndTextures\": () => (/* binding */ h),\n/* harmony export */   \"getMaterialAndTexturesFromShared\": () => (/* binding */ b),\n/* harmony export */   \"getSupportedEncodings\": () => (/* binding */ D),\n/* harmony export */   \"selectEncoding\": () => (/* binding */ w)\n/* harmony export */ });\n/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/has.js */ \"./node_modules/@arcgis/core/core/has.js\");\n/* harmony import */ var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/mathUtils.js */ \"./node_modules/@arcgis/core/core/mathUtils.js\");\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _enums_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./enums.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/enums.js\");\n/* harmony import */ var _webgl_engine_core_material_RenderTexture_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../webgl-engine/core/material/RenderTexture.js */ \"./node_modules/@arcgis/core/views/3d/webgl-engine/core/material/RenderTexture.js\");\n/* harmony import */ var _webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRenderingParameters_glsl_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js */ \"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\");\n/* harmony import */ var _webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../webgl-engine/core/shaderLibrary/util/AlphaCutoff.js */ \"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\");\n/* harmony import */ var _webgl_engine_core_shaderLibrary_util_EllipsoidMode_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../webgl-engine/core/shaderLibrary/util/EllipsoidMode.js */ \"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/EllipsoidMode.js\");\n/* harmony import */ var _webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../webgl-engine/lib/basicInterfaces.js */ \"./node_modules/@arcgis/core/views/3d/webgl-engine/lib/basicInterfaces.js\");\n/* harmony import */ var _webgl_engine_lib_Texture_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../webgl-engine/lib/Texture.js */ \"./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Texture.js\");\n/* harmony import */ var _webgl_enums_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../webgl/enums.js */ \"./node_modules/@arcgis/core/views/webgl/enums.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nfunction h(e,a){const s=new Map,n=(e,a)=>{if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isNone)(e))return-1;const o=s.get(e.id);if(o)return o.usage|=a,o.id;const t=s.size;return s.set(e.id,{id:t,usage:a}),t},i=a.pbrMetallicRoughness,u=i&&i.baseColorFactor,c=a.emissiveFactor,d=null==a.normalTexture&&null==a.emissiveTexture&&null==a.occlusionTexture&&(!i||null==i.metallicRoughnessTexture&&1===i.roughnessFactor&&(1===i.metallicFactor||0===i.metallicFactor)),g=d?_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRenderingParameters_glsl_js__WEBPACK_IMPORTED_MODULE_5__.PBRSchematicMRRValues[0]:i?i.metallicFactor:1,p=d?_webgl_engine_core_shaderLibrary_shading_PhysicallyBasedRenderingParameters_glsl_js__WEBPACK_IMPORTED_MODULE_5__.PBRSchematicMRRValues[1]:i?i.roughnessFactor:1,h=\"mask\"===a.alphaMode?_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Color|_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.AlphaMask:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Color,x={baseColorFactor:u?[u[0],u[1],u[2],u[3]]:[1,1,1,1],baseColorTextureId:n(i&&i.baseColorTexture,h),metallicRoughnessTextureId:n(i&&i.metallicRoughnessTexture,_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.MetallicRoughness),metallicFactor:g,roughnessFactor:p},b={alphaMode:a.alphaMode,alphaCutoff:a.alphaCutoff,doubleSided:a.doubleSided,cullFace:\"none\"===a.cullFace?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.None:\"back\"===a.cullFace?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.Back:\"front\"===a.cullFace?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.Front:_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.None,normalTextureId:n(a.normalTexture,_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Normal),emissiveTextureId:n(a.emissiveTexture,_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Emissive),occlusionTextureId:n(a.occlusionTexture,_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Occlusion),emissiveFactor:c?[c[0],c[1],c[2]]:[0,0,0],metallicRoughness:x,wrapTextures:!1,hasParametersFromSource:d},F=[];return s.forEach((({usage:a},r)=>{const s=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(e)&&e[r]&&e[r].formats,t=s?f(s.map((({name:e,format:a})=>({name:e,encoding:T[a]})))):[];F.push({id:r,usage:a,encodings:t})})),{material:b,textures:F}}function f(e){return e.sort(((e,a)=>e.encoding-a.encoding))}const T={ktx2:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.KTX2,basis:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.Basis,dds:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.DDS_S3TC,png:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.PNG,jpg:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.JPG,\"ktx-etc2\":_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.KTX_ETC2},x={[_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.TextureEncodingMimeType.KTX2_ENCODING]:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.Basis,[_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.TextureEncodingMimeType.BASIS_ENCODING]:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.Basis,[_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.TextureEncodingMimeType.DDS_ENCODING]:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.DDS_S3TC,\"image/png\":_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.PNG,\"image/jpg\":_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.JPG,\"image/jpeg\":_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.JPG,\"image/ktx\":_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.KTX_ETC2};function b(a){const o=a&&a.materialDefinitions?Object.keys(a.materialDefinitions)[0]:null,r=a&&a.textureDefinitions?Object.keys(a.textureDefinitions)[0]:null,s=o?a.materialDefinitions?.[o]:null,n=r?a.textureDefinitions?.[r]:null,l=F();if(null!=s){const a=s.params;a.diffuse&&(l.metallicRoughness.baseColorFactor=[a.diffuse[0],a.diffuse[1],a.diffuse[2],1]),null!=a.doubleSided&&(l.doubleSided=a.doubleSided,l.cullFace=a.doubleSided?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.None:_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.Back),\"none\"!==a.cullFace&&\"front\"!==a.cullFace&&\"back\"!==a.cullFace||(l.cullFace=\"none\"===a.cullFace?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.None:\"back\"===a.cullFace?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.Back:_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.Front),a.transparency&&(l.metallicRoughness.baseColorFactor[3]=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.clamp)(1-a.transparency,0,1)),(a.useVertexColorAlpha||l.metallicRoughness.baseColorFactor[3]<1)&&(l.alphaMode=\"blend\")}const i=[];if(null!=n){const e=0;!n.wrap||\"repeat\"!==n.wrap[0]&&\"repeat\"!==n.wrap[1]||(l.wrapTextures=!0);let a=_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Color;\"rgba\"===n.channels&&(l.alphaMode=\"blend\",a|=_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.AlphaMask);const o=n.images.length-1,r=n.images[o],s=e=>e&&e.split(\"/\").pop(),u=Array.isArray(n.encoding)?f(n.encoding.map(((e,a)=>({name:s(r.href[a]),encoding:x[e]||0})))):[{name:s(r.href),encoding:x[n.encoding]||0}];i.push({id:e,usage:a,encodings:u}),l.metallicRoughness.baseColorTextureId=e}return{material:l,textures:i}}const F=()=>({alphaMode:\"opaque\",alphaCutoff:_webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_6__.defaultMaskAlphaCutoff,doubleSided:!0,cullFace:_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.CullFaceOptions.None,normalTextureId:-1,emissiveTextureId:-1,occlusionTextureId:-1,emissiveFactor:[0,0,0],metallicRoughness:{baseColorFactor:[.8,.8,.8,1],baseColorTextureId:-1,metallicRoughnessTextureId:-1,metallicFactor:0,roughnessFactor:.6},wrapTextures:!1,hasParametersFromSource:!0});function C(e,o,s,n){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isNone)(e)||null==e.data)return null;const l=e.data,i=!(l instanceof HTMLImageElement)||(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.isPowerOfTwo)(l.width)&&(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.isPowerOfTwo)(l.height),u=n.renderingContext.parameters.maxMaxAnisotropy,c=s&&!n.capabilities.shaderTextureLOD?1:u,m=i&&!e.downsampled&&c>1,d=s||!o.wrapTextures?P:M,p=E(e.encoding),h=e.usage&_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Color?\"opaque\"===o.alphaMode?3:4:3;return new _webgl_engine_lib_Texture_js__WEBPACK_IMPORTED_MODULE_9__.Texture(l,{mipmap:m,maxAnisotropy:c,encoding:p,wrap:d,components:h,noUnpackFlip:!0})}const P={s:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_10__.TextureWrapMode.CLAMP_TO_EDGE,t:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_10__.TextureWrapMode.CLAMP_TO_EDGE},M={s:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_10__.TextureWrapMode.REPEAT,t:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_10__.TextureWrapMode.REPEAT};function S(a,r,s,l,c,m){const g=m.rendererTextureUsage,p=e=>R(l,s,e&g),h=r.metallicRoughness.baseColorFactor,f=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_1__.clamp)(r.metallicRoughness.baseColorFactor[3],0,1);a.baseColor=[h[0],h[1],h[2],f],a.hasParametersFromSource=!!r.hasParametersFromSource,a.usePBR=m.usePBR,a.mrrFactors=[r.metallicRoughness.metallicFactor,r.metallicRoughness.roughnessFactor,r.hasParametersFromSource?.2:.5],a.emissiveFactor=r.emissiveFactor,a.isIntegratedMesh=m.isIntegratedMesh,a.textureAlphaCutoff=\"mask\"===r.alphaMode?r.alphaCutoff:_webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_6__.defaultMaskAlphaCutoff,a.alphaDiscardMode=\"opaque\"===r.alphaMode?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.AlphaDiscardMode.Opaque:\"mask\"===r.alphaMode?_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.AlphaDiscardMode.Mask:_webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.AlphaDiscardMode.MaskBlend;const T=[],x=p(_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Color|_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.AlphaMask);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(x)&&(a.baseColorTexture=new _webgl_engine_core_material_RenderTexture_js__WEBPACK_IMPORTED_MODULE_4__.RenderTexture(c,x),T.push(a.baseColorTexture.loadPromise));const b=p(_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.MetallicRoughness);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(b)&&(a.metallicRoughnessTexture=new _webgl_engine_core_material_RenderTexture_js__WEBPACK_IMPORTED_MODULE_4__.RenderTexture(c,b),T.push(a.metallicRoughnessTexture.loadPromise));const F=p(_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Emissive);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(F)&&(a.emissionTexture=new _webgl_engine_core_material_RenderTexture_js__WEBPACK_IMPORTED_MODULE_4__.RenderTexture(c,F),T.push(a.emissionTexture.loadPromise));const C=p(_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Occlusion);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(C)&&(a.occlusionTexture=new _webgl_engine_core_material_RenderTexture_js__WEBPACK_IMPORTED_MODULE_4__.RenderTexture(c,C),T.push(a.occlusionTexture.loadPromise));const P=p(_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.Normal);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(P)&&(a.normalTexture=new _webgl_engine_core_material_RenderTexture_js__WEBPACK_IMPORTED_MODULE_4__.RenderTexture(c,P),T.push(a.normalTexture.loadPromise)),a.commonMaterialParameters.hasSlicePlane=m.slicePlaneEnabled,a.commonMaterialParameters.doubleSided=r.doubleSided,a.commonMaterialParameters.cullFace=r.cullFace,a.ellipsoidMode=(0,_webgl_engine_core_shaderLibrary_util_EllipsoidMode_js__WEBPACK_IMPORTED_MODULE_7__.getEllipsoidMode)(m.viewSpatialReference),Promise.all(T)}function D(e){const a=!!e.compressedTextureS3TC,o=!!e.compressedTextureETC,r=(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(\"disable-feature:i3s-basis\")?0:_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.Basis|_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.KTX2,t=_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.JPG|_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.PNG,n=r|_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.DDS_S3TC;return t|(a?n:0)|(o?r:0)}function w(e,a){if(null!=a)return e.find((e=>0!=(e.encoding&a)))}function R(e,a,s){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isNone)(e)||s===_enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureUsage.None)return null;for(let r=0;r<e.length;r++){const t=e[r];if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(t)&&0!=(t.usage&s)){const e=a[r];return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_2__.isSome)(e)?e.id:null}}return null}function E(e){switch(e){case _enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.KTX2:return _webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.TextureEncodingMimeType.KTX2_ENCODING;case _enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.Basis:return _webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.TextureEncodingMimeType.BASIS_ENCODING;case _enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.DDS_S3TC:return _webgl_engine_lib_basicInterfaces_js__WEBPACK_IMPORTED_MODULE_8__.TextureEncodingMimeType.DDS_ENCODING;case _enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.PNG:return\"image/png\";case _enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.JPG:return\"image/jpeg\";case _enums_js__WEBPACK_IMPORTED_MODULE_3__.TextureEncoding.KTX_ETC2:return\"image/ktx\";default:return\"\"}}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SMaterialUtil.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js":
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"CacheState\": () => (/* binding */ s),\n/* harmony export */   \"ElevationRange\": () => (/* binding */ i),\n/* harmony export */   \"LodMetric\": () => (/* binding */ a),\n/* harmony export */   \"Node\": () => (/* binding */ h),\n/* harmony export */   \"NodeBase\": () => (/* binding */ t),\n/* harmony export */   \"NodeFilterImpact\": () => (/* binding */ n),\n/* harmony export */   \"NodeIMModificationImpact\": () => (/* binding */ o),\n/* harmony export */   \"NodeState\": () => (/* binding */ c),\n/* harmony export */   \"NodeTraversalState\": () => (/* binding */ d)\n/* harmony export */ });\n/* harmony import */ var _chunks_sphere_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../chunks/sphere.js */ \"./node_modules/@arcgis/core/chunks/sphere.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nclass t{constructor(t,i){this.id=t,this.mbs=i,this.renderMbs=(0,_chunks_sphere_js__WEBPACK_IMPORTED_MODULE_0__.f)(0,0,0,-1),this.elevationRange=null}}class i{constructor(){this.min=1/0,this.max=-1/0,this.valid=!1}}var n,o,s,a,c;!function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.Culled=1]=\"Culled\",e[e.NotChecked=2]=\"NotChecked\"}(n||(n={})),function(e){e[e.Unmodified=0]=\"Unmodified\",e[e.PotentiallyModified=1]=\"PotentiallyModified\",e[e.Culled=2]=\"Culled\",e[e.Unknown=3]=\"Unknown\",e[e.NotChecked=4]=\"NotChecked\"}(o||(o={}));class h extends t{constructor(e,t,i,n,a,c,h,d,r,l){super(e,i),this.index=t,this.childCount=n,this.level=a,this.resources=c,this.version=h,this.lodMetric=d,this.maxError=r,this.numFeatures=l,this.failed=!1,this.cacheState=s.Unknown,this.vertexCount=0,this.memory=0,this.childrenLoaded=0,this.hasModifications=!1,this.imModificationImpact=o.NotChecked}}!function(e){e[e.Unknown=0]=\"Unknown\",e[e.Uncached=1]=\"Uncached\",e[e.Cached=2]=\"Cached\"}(s||(s={})),function(e){e[e.None=0]=\"None\",e[e.MaxScreenThreshold=1]=\"MaxScreenThreshold\",e[e.ScreenSpaceRelative=2]=\"ScreenSpaceRelative\",e[e.RemovedFeatureDiameter=3]=\"RemovedFeatureDiameter\",e[e.DistanceRangeFromDefaultCamera=4]=\"DistanceRangeFromDefaultCamera\"}(a||(a={})),function(e){e[e.Hole=0]=\"Hole\",e[e.Leaf=1]=\"Leaf\"}(c||(c={}));class d{constructor(e,t,i,n){this.nodeHasLOD=e,this.isChosen=t,this.lodLevel=i,this.version=n}}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNodeLoader.js":
/*!************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNodeLoader.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ m)\n/* harmony export */ });\n/* harmony import */ var _core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/asyncUtils.js */ \"./node_modules/@arcgis/core/core/asyncUtils.js\");\n/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../core/has.js */ \"./node_modules/@arcgis/core/core/has.js\");\n/* harmony import */ var _core_lang_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../core/lang.js */ \"./node_modules/@arcgis/core/core/lang.js\");\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../core/promiseUtils.js */ \"./node_modules/@arcgis/core/core/promiseUtils.js\");\n/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../core/urlUtils.js */ \"./node_modules/@arcgis/core/core/urlUtils.js\");\n/* harmony import */ var _enums_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./enums.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/enums.js\");\n/* harmony import */ var _I3SBinaryReader_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./I3SBinaryReader.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SBinaryReader.js\");\n/* harmony import */ var _I3SMaterialUtil_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./I3SMaterialUtil.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SMaterialUtil.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nclass m{constructor(e,t,r,i,o,n){if(this._streamDataController=t,this._logger=r,this._defaultGeometrySchema=i,this._requiredAttributes=o,this._options=n,this._logLayer=e,this._layerUrl=e.parsedUrl.path,this._geometryDefinitions=e.geometryDefinitions,e.materialDefinitions){const t=e.textureSetDefinitions;this._materialAndTextures=e.materialDefinitions.map((e=>(0,_I3SMaterialUtil_js__WEBPACK_IMPORTED_MODULE_8__.getMaterialAndTextures)(t,e)))}}_load(e,t,r){return this._streamDataController.request(e,t,r)}_loadAttribute(e,t,r){const i=`${this._layerUrl}/nodes/${e.resources.attributes}/attributes/${t.key}/0`;return this._load(i,\"binary\",r).then((e=>(0,_I3SBinaryReader_js__WEBPACK_IMPORTED_MODULE_7__.readBinaryAttribute)(t,e)))}loadAttributes(e,t,r){return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.eachAlways)(t.map((t=>this._loadAttribute(e,t.attributeStorageInfo,r)))).then((r=>{const i={};for(let o=0;o<t.length;++o){const n=r[o].value;if(n)i[t[o].name]=n;else{if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.isAbortError)(r[o].error))throw r[o].error;this._logger.error(\"#loadAttributes\",this._logLayer,`Failed to load attributeData for '${t[o].name}' on node '${e.id}'`,r[o].error)}}return i}))}async loadNodeData(r,n){const s=null!=this._requiredAttributes&&r.resources.attributes?(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.result)(this.loadAttributes(r,this._requiredAttributes,n)):null,{bufferDefinition:a,bufferIndex:u}=D(this._geometryDefinitions,r),l=!!r.resources.geometry,d=l?(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.result)(this._loadGeometry(r.resources.geometry,u,n)):null,h=r.resources.hasSharedResource?await this._loadShared(r,n):null,m=r.resources.materialDefinition,p=this._materialAndTextures&&null!=m&&m>=0?this._materialAndTextures[m]:null!=h?(0,_I3SMaterialUtil_js__WEBPACK_IMPORTED_MODULE_8__.getMaterialAndTexturesFromShared)(h):null,x=p?.material,A=p?.textures??[],w=`${r.id}`,T=!l&&this._options.loadFeatureData,$=T?await this._loadFeatureData(w,n):null,j=T?_($):g(x),I=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__.isNone)(j)?b($):null,U=A.length>0?(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.result)(this.loadTextures(r,A,n)):null;let S=null,q=null;if(d){S=(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.assertResult)(await d);const e=y(this._defaultGeometrySchema,h);q=(0,_I3SBinaryReader_js__WEBPACK_IMPORTED_MODULE_7__.createGeometryDescriptor)(a,e)}const B=U?(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.assertResult)(await U):null,C=s?(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.assertResult)(await s):{},E=C?{attributeData:C,loadedAttributes:this._requiredAttributes}:null;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__.isSome)(j))return{geometryData:j,attributeDataInfo:E,geometryBuffer:S,geometryDescriptor:q,requiredTextures:A,textureData:B};if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_3__.isSome)(I))return{pointData:I,attributeDataInfo:E,geometryBuffer:S,geometryDescriptor:q,requiredTextures:A,textureData:B};throw new Error}static _addAbsoluteHrefTexture(e,t){const r=e.textureDefinitions;if(null!=r)for(const i of Object.keys(r))for(const e of r[i].images)Array.isArray(e.href)?e.hrefConcat=e.href.map((e=>(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeAbsolute)(e,t))):e.hrefConcat=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_5__.makeAbsolute)(e.href,t)}static _fixTextureEncodings(e){const t=e.textureDefinitions;if(null!=t)for(const r in t){const e=t[r];if(Array.isArray(e.encoding))for(let t=0;t<e.encoding.length;t++){const r=e.encoding[t];\"data:\"===r.substring(0,5)&&(e.encoding[t]=r.substring(5))}else{const t=e.encoding;\"data:\"===t.substring(0,5)&&(e.encoding=t.substring(5))}}}_loadShared(e,t){const r=`${this._layerUrl}/nodes/${e.resources.geometry}/shared`;return this._load(r,\"json\",t).then((e=>(m._fixTextureEncodings(e),m._addAbsoluteHrefTexture(e,r),e)))}_loadTexture(e,t,r,i,o,n){let s=!1;return o===_enums_js__WEBPACK_IMPORTED_MODULE_6__.TextureEncoding.DDS_S3TC||o===_enums_js__WEBPACK_IMPORTED_MODULE_6__.TextureEncoding.KTX2||o===_enums_js__WEBPACK_IMPORTED_MODULE_6__.TextureEncoding.Basis?this._load(e,\"binary\",n).then((e=>({id:t,usage:r,data:e,encoding:o,downsampled:s}))):this._load(e,\"image\",n).then((e=>{let n=e;const a=4096,u=2;if(i&&e.width*e.height>=a){const t=Math.ceil(e.width/u),r=Math.ceil(e.height/u),i=document.createElement(\"canvas\");i.width=t,i.height=r;i.getContext(\"2d\").drawImage(e,0,0,t,r),n=i,s=!0}return{id:t,usage:r,data:n,encoding:o,downsampled:s}}))}loadTextures(e,t,r){const i=!!this._options.uncompressedTextureDownsamplingEnabled,o=this._options.textureUsageMask;return Promise.all(t.map((t=>{if(0==(t.usage&o))return null;const n=(0,_I3SMaterialUtil_js__WEBPACK_IMPORTED_MODULE_8__.selectEncoding)(t.encodings,this._options.textureEncodings);if(null==n)return this._logger.error(\"#loadTextures\",this._logLayer,`No known encoding for texture found on node ${e.id}`),Promise.reject();const s=e.resources.texture||e.id,a=`${this._layerUrl}/nodes/${s}/textures/${n.name}`;return this._loadTexture(a,t.id,t.usage,i,n.encoding,r)})))}_loadFeatureData(e,t){const r=`${this._layerUrl}/nodes/${e}/features/0`;return this._load(r,\"json\",t)}_loadGeometry(e,t,r){const i=`${this._layerUrl}/nodes/${e}/geometries/${t}`;return this._load(i,\"binary\",r)}}function g(e){return{featureIds:[],geometries:[{type:\"ArrayBufferView\",params:{material:e}}],featureDataPosition:[0,0,0]}}function _(e){if(!e)return null;for(const t of e.featureData){const e=t.geometries;if(null!=e)for(const r of e)return{featureIds:[t.id],featureDataPosition:t.position,geometries:[r]}}return null}function b(e){if(!e)return null;const t=new Array;for(const r of e.featureData)null!=r.position&&t.push({featureIds:[r.id],featureDataPosition:r.position,geometries:[]});return t}function y(e,t){if(!e||!t||!t.materialDefinitions)return e;const i=Object.keys(t.materialDefinitions)[0];return!t.materialDefinitions[i].params.vertexRegions&&e.vertexAttributes.region&&delete(e=(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.clone)(e)).vertexAttributes.region,e}function D(e,t){const r={bufferDefinition:null,bufferIndex:0},i=t.resources.geometryDefinition;if(null==e||null==i||i<0)return r;const o=i>=0?e[i].geometryBuffers:null;if(null==o)return r;for(let n=0;n<o.length;n++){const e=o[n];if(null==e.compressedAttributes)r.bufferIndex=n,r.bufferDefinition=o[n];else if(\"draco\"===e.compressedAttributes.encoding&&!(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(\"disable-feature:i3s-draco\"))return r.bufferIndex=n,r.bufferDefinition=e,r}return r}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNodeLoader.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SOverrides.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SOverrides.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"I3SOverrides\": () => (/* binding */ A)\n/* harmony export */ });\n/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../chunks/tslib.es6.js */ \"./node_modules/@arcgis/core/chunks/tslib.es6.js\");\n/* harmony import */ var _request_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../request.js */ \"./node_modules/@arcgis/core/request.js\");\n/* harmony import */ var _core_Accessor_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../core/Accessor.js */ \"./node_modules/@arcgis/core/core/Accessor.js\");\n/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../core/arrayUtils.js */ \"./node_modules/@arcgis/core/core/arrayUtils.js\");\n/* harmony import */ var _core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../core/asyncUtils.js */ \"./node_modules/@arcgis/core/core/asyncUtils.js\");\n/* harmony import */ var _core_byteSizeEstimations_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../core/byteSizeEstimations.js */ \"./node_modules/@arcgis/core/core/byteSizeEstimations.js\");\n/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../core/Logger.js */ \"./node_modules/@arcgis/core/core/Logger.js\");\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../core/promiseUtils.js */ \"./node_modules/@arcgis/core/core/promiseUtils.js\");\n/* harmony import */ var _core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../core/reactiveUtils.js */ \"./node_modules/@arcgis/core/core/reactiveUtils.js\");\n/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../core/accessorSupport/decorators/property.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js\");\n/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../core/accessorSupport/ensureType.js */ \"./node_modules/@arcgis/core/core/accessorSupport/ensureType.js\");\n/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../../core/accessorSupport/decorators/subclass.js */ \"./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js\");\n/* harmony import */ var _intl_number_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../../intl/number.js */ \"./node_modules/@arcgis/core/intl/number.js\");\n/* harmony import */ var _layers_support_featureQueryAll_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../../layers/support/featureQueryAll.js */ \"./node_modules/@arcgis/core/layers/support/featureQueryAll.js\");\n/* harmony import */ var _support_featureFlags_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../../support/featureFlags.js */ \"./node_modules/@arcgis/core/support/featureFlags.js\");\n/* harmony import */ var _FeatureLayerView3D_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../FeatureLayerView3D.js */ \"./node_modules/@arcgis/core/views/3d/layers/FeatureLayerView3D.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nlet A=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]{constructor(e){super(e),this._warnMaximumChangedObjectsExceeded=!1,this._interactiveEditingSessions=null,this._maximumNumberOfEditOVerrides=S,this._original3DOFLDefinitionExpression=null,this._associatedLayerView=null,this._changedObjectIds=new Set,this._pendingFetchChangedObjectIds=null,this._pendingFetchAbortController=new AbortController}initialize(){this._memCache=this.memoryController.newCache(`${this.layer.uid}-attribute-overrides`),this._pendingFetchChangedObjectIds=this._fetchChangedObjectIds(this._pendingFetchAbortController?.signal),this._pendingFetchChangedObjectIds.then((()=>{this._pendingFetchAbortController=null,this._pendingFetchChangedObjectIds=null})),this.is3DOFL&&(0,_support_featureFlags_js__WEBPACK_IMPORTED_MODULE_15__.enableDirect3DObjectFeatureLayerDisplay)()&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(this._associatedLayer)&&this._associatedLayer.load().then((e=>{this.destroyed||(this._original3DOFLDefinitionExpression=e.definitionExpression,this.addHandles((0,_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.watch)((()=>this._definitionExpression),(t=>e.definitionExpression=t),_core_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_9__.initial)),this._associatedLayerView=new _FeatureLayerView3D_js__WEBPACK_IMPORTED_MODULE_16__[\"default\"]({layer:this._associatedLayer,view:this.view}))}))}destroy(){this.is3DOFL&&(0,_support_featureFlags_js__WEBPACK_IMPORTED_MODULE_15__.enableDirect3DObjectFeatureLayerDisplay)()&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(this._associatedLayerView)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(this._associatedLayer)&&(this._associatedLayer.definitionExpression=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.unwrap)(this._original3DOFLDefinitionExpression)),this._set(\"layer\",null),this._memCache=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.destroyMaybe)(this._memCache),this._pendingFetchAbortController=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.abortMaybe)(this._pendingFetchAbortController),this._pendingFetchChangedObjectIds=null}get is3DOFL(){return (0,_support_featureFlags_js__WEBPACK_IMPORTED_MODULE_15__.sceneLayerEditingEnabled)()&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(this._associatedLayer)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(this._associatedLayer.infoFor3D)}get geometryChangedObjectIds(){return this.is3DOFL?[...this._changedObjectIds]:[]}get _associatedLayer(){return null==this.layer?null:this.layer.associatedLayer}get _definitionExpression(){const e=this.geometryChangedObjectIds;return 0===e.length?\"1 = 0\":`OBJECTID IN (${e.join(\",\")})`}get updating(){if(!this.is3DOFL)return!1;if(!(0,_support_featureFlags_js__WEBPACK_IMPORTED_MODULE_15__.enableDirect3DObjectFeatureLayerDisplay)())return!1;return!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(this._associatedLayerView)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(this._associatedLayerView)&&this._associatedLayerView.updating}get isEmpty(){return null==this._pendingFetchChangedObjectIds&&0===this._changedObjectIds.size}createInteractiveEditSession(e){this._changedObjectIds.add(e),this.notifyChange(\"_changedObjectIds\"),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(this._interactiveEditingSessions)&&(this._interactiveEditingSessions=[]);const t=this._interactiveEditingSessions,s=new F(e,{rollback:()=>{(0,_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_3__.remove)(t,s),0===t.length&&(this._interactiveEditingSessions=null)},commit:t=>{for(const[s,i]of t)this.updateAttributeValue(e,s,i)}});return t.unshift(s),s}async apply(e,t,s){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(t))return;const{loadedAttributes:i,attributeData:r}=t;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(i)||0===i.length||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(r))return;if(this._pendingFetchChangedObjectIds&&await (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.whenOrAbort)(this._pendingFetchChangedObjectIds,s),0===this._changedObjectIds.size)return;const a={loadedAttributes:i,attributeData:r},n=this._getOverridesFromCache(e,a,this._changedObjectIds),{objectIds:o,fieldNames:c}=n;if(0===o.length||0===c.length)return;const d=await this._queryOverridesFromAssociatedLayer(o,c,s);(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(d)||this._processOverridesFromAssociatedLayer(e,d,c,a)}updateGeometry(e){this._changedObjectIds.add(e),this.notifyChange(\"_changedObjectIds\")}updateAttributeValue(e,t,s){this._changedObjectIds.add(e),this._cacheAttributeValue(e,t,s),this.notifyChange(\"_changedObjectIds\")}_cacheAttributeValue(e,t,s){this._memCache.put(this._getAttributeCacheKey(e,t),s,this._memCacheAttributeValueSize(s))}_getOverridesFromCache(e,{loadedAttributes:t,attributeData:s},i){const r=new Set,a=new Array;for(const o of t)a[o.index]=s[o.name];const n=new Set;for(let o=0;o<e.length;o++){const s=e[o];if(i.has(s))for(const e of t){const t=this._fromCache(s,e.index);void 0===t?(r.add(s),n.add(e.name)):a[e.index][o]=t}}return{objectIds:Array.from(r),fieldNames:Array.from(n)}}_fromCache(e,t){const s=this._fromInteractiveEditingSession(e,t);if(void 0!==s)return s;const i=this._getAttributeCacheKey(e,t);return this._memCache.get(i)}_fromInteractiveEditingSession(e,t){if(!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(this._interactiveEditingSessions))for(const s of this._interactiveEditingSessions){if(s.objectId!==e)continue;const i=s.get(t);if(void 0!==i)return i}}_getAttributeCacheKey(e,t){return`${e}-${t}`}async _queryOverridesFromAssociatedLayer(e,t,s){if(0===e.length||0===t.length)return null;e=e.sort(((e,t)=>e-t)),this._warnMaximumChangedObjectsExceeded&&(this._warnMaximumChangedObjectsExceeded=!1,this._logMaximumObjectsExceededWarning());const i=this.layer.associatedLayer;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(i))return null;const n=i.createQuery();n.where=\"1=1\",n.returnGeometry=!1,n.outFields=[i.objectIdField,...t],n.cacheHint=!0,n.objectIds=e;const o=(0,_layers_support_featureQueryAll_js__WEBPACK_IMPORTED_MODULE_14__.getMaximumQuerySize)(i),c=e.length>o?(0,_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_3__.splitIntoChunks)(e,o).map((e=>{const t=n.clone();return t.objectIds=e,(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_4__.resultOrAbort)((0,_layers_support_featureQueryAll_js__WEBPACK_IMPORTED_MODULE_14__.queryAllJSON)(i,t,{signal:s}))})):[(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_4__.resultOrAbort)((0,_layers_support_featureQueryAll_js__WEBPACK_IMPORTED_MODULE_14__.queryAllJSON)(i,n,{signal:s}))];return(await Promise.all(c)).reduce(((e,t)=>e.concat(t.ok?t.value.features:[])),[])}_logMaximumObjectsExceededWarning(){let e=`The number of edited objects that are not yet cached in the scene service exceeds the maximum limit. Attribute changes will only be available for the first ${(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_13__.formatNumber)(this._maximumNumberOfEditOVerrides)} objects. Please consider re-caching the scene service`;const t=this.layer.portalItem;t&&t.loaded?e+=` (${t.portal.url}/home/item.html?id=${t.id}#settings)`:e+=` (${this.layer.parsedUrl.path})`,_core_Logger_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"].getLogger(\"esri.views.3d.layers.i3s.I3SOverrides\").warn(\"#queryOverrides()\",this.layer.title,`${e}.`)}_processOverridesFromAssociatedLayer(e,t,s,{loadedAttributes:i,attributeData:r}){const a=this.layer.associatedLayer;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(a))return;const n=a.objectIdField,o=s.map((e=>r[e])),c=new Map(i.map((e=>[e.name,e.index]))),d=s.map((e=>c.get(e))),h=new Map(Array.from(e,((e,t)=>[e,t])));for(const l of t){const e=l.attributes[n];for(let t=0;t<s.length;t++){const i=d[t],r=h.get(e),a=l.attributes[s[t]];o[t][r]=a,this._cacheAttributeValue(e,i,a)}}}_memCacheAttributeValueSize(e){return\"string\"==typeof e?(0,_core_byteSizeEstimations_js__WEBPACK_IMPORTED_MODULE_5__.estimateStringByteSize)(e):(0,_core_byteSizeEstimations_js__WEBPACK_IMPORTED_MODULE_5__.estimateNumberByteSize)()}async _fetchChangedObjectIds(e){const s=this.layer;if(await s.load({signal:e}),this._changedObjectIds.clear(),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(s.associatedLayer)||!s.associatedLayer.capabilities?.operations?.supportsChangeTracking)return;const i=this._getFetchChangedObjectIdsServerGen();if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isNone)(i))return;const r=s.associatedLayer.layerId,a=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(s.associatedLayer.infoFor3D),o=await (0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_4__.result)((0,_request_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(`${s.associatedLayer.url}/extractChanges`,{method:\"post\",query:{f:\"json\",returnIdsOnly:!0,layers:`[${r}]`,returnUpdates:!0,returnDeletes:a,returnInserts:a,layerServerGens:JSON.stringify([{id:r,serverGen:i}])},timeout:w,signal:e}));if(o.ok&&o.value.data?.edits&&1===o.value.data.edits.length){const e=o.value.data.edits[0],t=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.get)(e,\"objectIds\",\"adds\"),s=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.get)(e,\"objectIds\",\"updates\"),i=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.get)(e,\"objectIds\",\"deletes\");let r=[];(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(t)&&(r=r.concat(t)),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(s)&&(r=r.concat(s)),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(i)&&(r=r.concat(i));const a=Math.min(this._maximumNumberOfEditOVerrides,r.length);a<r.length&&(this._warnMaximumChangedObjectsExceeded=!0);const n=r.sort(((e,t)=>e-t));for(let o=0;o<a;o++)this._changedObjectIds.add(n[o])}this.notifyChange(\"_changedObjectIds\")}_getFetchChangedObjectIdsServerGen(){const e=this.layer;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(e.serviceUpdateTimeStamp)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(e.serviceUpdateTimeStamp.lastUpdate))return e.serviceUpdateTimeStamp.lastUpdate;const t=e.associatedLayer;return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(t)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(t.serverGens)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_7__.isSome)(t.serverGens.minServerGen)?t.serverGens.minServerGen:null}get test(){const e=Array.from(this._changedObjectIds),t=this._pendingFetchChangedObjectIds,s=this;return{changedObjectIds:e,pendingFetchChangedObjectIds:t,get maximumNumberOfEditOVerrides(){return s._maximumNumberOfEditOVerrides},set maximumNumberOfEditOVerrides(e){s._maximumNumberOfEditOVerrides=e}}}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({constructOnly:!0})],A.prototype,\"view\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({constructOnly:!0})],A.prototype,\"layer\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],A.prototype,\"is3DOFL\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({readOnly:!0})],A.prototype,\"geometryChangedObjectIds\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],A.prototype,\"_associatedLayer\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],A.prototype,\"_associatedLayerView\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)({constructOnly:!0})],A.prototype,\"memoryController\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],A.prototype,\"_changedObjectIds\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],A.prototype,\"_pendingFetchChangedObjectIds\",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],A.prototype,\"_definitionExpression\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],A.prototype,\"updating\",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_10__.property)()],A.prototype,\"isEmpty\",null),A=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_12__.subclass)(\"esri.views.3d.layers.i3s.I3SOverrides\")],A);class F{constructor(e,t){this.objectId=e,this._options=t,this._updates=new Map,this._state=x.ACTIVE}get(e){return this._updates.get(e)}set(e,t){this._isActive&&this._updates.set(e,t)}rollback(){this._isActive&&(this._state=x.ROLLED_BACK,this._options.rollback())}commit(){this._isActive&&(this._state=x.COMMITTED,this._options.commit(this._updates),this._updates.clear())}get _isActive(){return this._state===x.ACTIVE}}var x;!function(e){e[e.ACTIVE=0]=\"ACTIVE\",e[e.COMMITTED=1]=\"COMMITTED\",e[e.ROLLED_BACK=2]=\"ROLLED_BACK\"}(x||(x={}));const w=1e4,S=5e4;\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SOverrides.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SStreamDataController.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SStreamDataController.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"I3SStreamDataController\": () => (/* binding */ r)\n/* harmony export */ });\n/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/promiseUtils.js */ \"./node_modules/@arcgis/core/core/promiseUtils.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nclass r{constructor(e,t){this._requester=e,this._apiKey=t,this._activeRequests=new Set}get busy(){return this._requester.busy}request(r,s,o){const l=new AbortController,a=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.onAbortOrThrow)(o,(()=>l.abort())),n={signal:l.signal,query:{token:this._apiKey}},i=this._requester.request(r,s,n),u={response:i,abortController:l,abortHandle:a};return this._activeRequests.add(u),(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_0__.always)(i,(()=>{u.abortController=null,u.abortHandle?.remove(),u.abortHandle=null,this._activeRequests.delete(u)})),i}cancelAll(){this._activeRequests.forEach((e=>{e.abortController?.abort(),e.abortController=null,e.abortHandle?.remove()})),this._activeRequests.clear()}}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SStreamDataController.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/I3SViewportQueries.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/I3SViewportQueries.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ A)\n/* harmony export */ });\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../chunks/vec3.js */ \"./node_modules/@arcgis/core/chunks/vec3.js\");\n/* harmony import */ var _chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../chunks/vec3f64.js */ \"./node_modules/@arcgis/core/chunks/vec3f64.js\");\n/* harmony import */ var _chunks_vec4_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../chunks/vec4.js */ \"./node_modules/@arcgis/core/chunks/vec4.js\");\n/* harmony import */ var _geometry_ellipsoidUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../geometry/ellipsoidUtils.js */ \"./node_modules/@arcgis/core/geometry/ellipsoidUtils.js\");\n/* harmony import */ var _geometry_projection_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../geometry/projection.js */ \"./node_modules/@arcgis/core/geometry/projection.js\");\n/* harmony import */ var _geometry_spatialReferenceEllipsoidUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../geometry/spatialReferenceEllipsoidUtils.js */ \"./node_modules/@arcgis/core/geometry/spatialReferenceEllipsoidUtils.js\");\n/* harmony import */ var _geometry_support_frustum_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../geometry/support/frustum.js */ \"./node_modules/@arcgis/core/geometry/support/frustum.js\");\n/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../geometry/support/spatialReferenceUtils.js */ \"./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js\");\n/* harmony import */ var _chunks_sphere_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../chunks/sphere.js */ \"./node_modules/@arcgis/core/chunks/sphere.js\");\n/* harmony import */ var _layers_graphics_dehydratedFeatures_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../layers/graphics/dehydratedFeatures.js */ \"./node_modules/@arcgis/core/layers/graphics/dehydratedFeatures.js\");\n/* harmony import */ var _graphics_elevationAlignmentUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../graphics/elevationAlignmentUtils.js */ \"./node_modules/@arcgis/core/views/3d/layers/graphics/elevationAlignmentUtils.js\");\n/* harmony import */ var _graphics_ElevationContext_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../graphics/ElevationContext.js */ \"./node_modules/@arcgis/core/views/3d/layers/graphics/ElevationContext.js\");\n/* harmony import */ var _graphics_featureExpressionInfoUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../graphics/featureExpressionInfoUtils.js */ \"./node_modules/@arcgis/core/views/3d/layers/graphics/featureExpressionInfoUtils.js\");\n/* harmony import */ var _I3SNode_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./I3SNode.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SNode.js\");\n/* harmony import */ var _I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./I3SUtil.js */ \"./node_modules/@arcgis/core/views/3d/layers/i3s/I3SUtil.js\");\n/* harmony import */ var _support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../support/orientedBoundingBox.js */ \"./node_modules/@arcgis/core/views/3d/support/orientedBoundingBox.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nconst I=1e5;class A{constructor(e,t,i,s,r,n,o,a,h={}){this._indexSR=e,this._renderCoordsHelper=t,this._clippingArea=r,this._elevationProvider=n,this._viewingMode=o,this._options=h,this._frustum=(0,_geometry_support_frustum_js__WEBPACK_IMPORTED_MODULE_7__.create)(),this._useFrustumCulling=!1,this._poi=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),this._elevationContext=null,this.minDistance=1/0,this.maxDistance=0,this.maxLodLevel=2,this._tmpObb=(0,_support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_16__.create)(),this._tmp1=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),this._tmp2=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),this._tmp3=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),this._tmp0=(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),this._screenspaceErrorBias=h.screenspaceErrorBias||1,this._progressiveLoadFactor=h.progressiveLoadFactor||1,this.updateCamera(i,s),this.engineSR=this._renderCoordsHelper.spatialReference,this.updateElevationInfo(a),this._tmpPoint=(0,_layers_graphics_dehydratedFeatures_js__WEBPACK_IMPORTED_MODULE_10__.makeDehydratedPoint)(0,0,0,e),this._isECEFOBBInLocalMode=this._indexSR.isWGS84&&(this.engineSR.isWebMercator||(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_8__.isPlateCarree)(this.engineSR)),this._indexSREllipsoidRadius=(0,_geometry_ellipsoidUtils_js__WEBPACK_IMPORTED_MODULE_4__.getReferenceEllipsoid)(this._indexSR).radius}updateElevationInfo(e){null!=e?(this._elevationContext=_graphics_ElevationContext_js__WEBPACK_IMPORTED_MODULE_12__.ElevationContext.fromElevationInfo(e),this._elevationContext.updateFeatureExpressionInfoContext((0,_graphics_featureExpressionInfoUtils_js__WEBPACK_IMPORTED_MODULE_13__.createContextWithoutExpressionSupport)((0,_graphics_featureExpressionInfoUtils_js__WEBPACK_IMPORTED_MODULE_13__.extractExpressionInfo)(e,!1)))):this._elevationContext=null}updateCamera(e,t){this._useFrustumCulling=t,t&&(0,_geometry_support_frustum_js__WEBPACK_IMPORTED_MODULE_7__.fromMatrix)(e.viewMatrix,e.projectionMatrix,this._frustum),this._screenSizeFactor=1/(e.perScreenPixelRatio/2),this._camPos=e.eye,this.minDistance=1/0,this.maxDistance=0}setPointOfInterest(e){this._poi=e}updateScreenSpaceErrorBias(e){const t=this._screenspaceErrorBias;return this._screenspaceErrorBias=e,t}updateClippingArea(e){this._clippingArea=e}getElevationRange(i){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(this._elevationContext))return null;const s=i.mbs;if(!s)return null;const r=s[0],n=s[1],o=s[2],a=s[3],h=\"relative-to-scene\"===this._elevationContext.mode?\"scene\":\"ground\";if(this._elevationProvider.getSphereElevationBounds)return this._elevationProvider.getSphereElevationBounds(r,n,o,a,this._indexSR,h);const c=this._elevationProvider.getElevation(r,n,o,this._indexSR,h);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(c)?{min:c,max:c}:null}getRenderMbs(e){const t=e.renderMbs;return (0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__.isValidMbs)(t)||(e.mbs&&(0,_chunks_vec4_js__WEBPACK_IMPORTED_MODULE_3__.c)(t,e.mbs),this._elevationContext&&t[3]<I&&(this._tmpPoint.x=t[0],this._tmpPoint.y=t[1],this._tmpPoint.z=t[2],t[2]=(0,_graphics_elevationAlignmentUtils_js__WEBPACK_IMPORTED_MODULE_11__.evaluateElevationAlignmentAtPoint)(this._tmpPoint,this._elevationProvider,this._elevationContext,this._renderCoordsHelper)),(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_5__.projectBoundingSphere)(t,this._indexSR,t,this.engineSR)),t}getVisibilityObb(i){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i.visibilityObb))return i.visibilityObb;const s=i.serviceObb,r=.01*this._indexSREllipsoidRadius;return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s)||!i.mbs||!(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__.isValidObb)(s)||this._isECEFOBBInLocalMode&&s.halfSize.some((e=>e>r))?null:(i.serviceObbInRenderSR=this._computeRenderObb(s,i.serviceObbInRenderSR,i.mbs[3],i.elevationRange),i.serviceObbInRenderSR)}_computeRenderObb(i,s,r,n){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(s))s=(0,_support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_16__.create)();else if((0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__.isValidObb)(s))return s;let o=0,a=0;if(this._elevationContext&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(n)&&Number.isFinite(n.min))switch(this._elevationContext.mode){case\"relative-to-ground\":o=this._elevationContext.geometryZWithOffset(i.center[2],this._renderCoordsHelper)+n.min-i.center[2],a=n.max-n.min;break;case\"on-the-ground\":o=n.min-i.center[2],a=n.max-n.min}else this._elevationContext&&r<I&&(this._tmpPoint.x=i.center[0],this._tmpPoint.y=i.center[1],this._tmpPoint.z=i.center[2],o=(0,_graphics_elevationAlignmentUtils_js__WEBPACK_IMPORTED_MODULE_11__.evaluateElevationAlignmentAtPoint)(this._tmpPoint,this._elevationProvider,this._elevationContext,this._renderCoordsHelper)-i.center[2]);return a>0?((0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__.transformObb)(i,this._indexSR,this._tmpObb,this.engineSR,o),(0,_support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_16__.computeOffsetObb)(this._tmpObb,0,a,this._viewingMode,s)):(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__.transformObb)(i,this._indexSR,s,this.engineSR,o),s}isNodeVisible(e){const i=this.getRenderMbs(e);if(!this._isMBSinClippingArea(i))return!1;if(!this._useFrustumCulling)return!0;const s=this.getVisibilityObb(e);return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(s)?(0,_support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_16__.isVisible)(s,this._frustum):(0,_geometry_support_frustum_js__WEBPACK_IMPORTED_MODULE_7__.intersectsSphere)(this._frustum,(0,_chunks_sphere_js__WEBPACK_IMPORTED_MODULE_9__.w)(i))}isGeometryVisible(e){if(!this._useFrustumCulling)return!0;const i=e.geometryObb;return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(i)?(0,_support_orientedBoundingBox_js__WEBPACK_IMPORTED_MODULE_16__.isVisible)(i,this._frustum):this.isNodeVisible(e)}_isMBSinClippingArea(t){return!!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isNone)(this._clippingArea)||(0,_I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__.intersectBoundingRectWithMbs)(this._clippingArea,t)!==_I3SUtil_js__WEBPACK_IMPORTED_MODULE_15__.MbsIntersectResult.OUTSIDE}_screenSpaceDiameterMbs(e,t){const s=this.getRenderMbs(e),r=Math.sqrt((0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.d)(s,this._camPos)),n=r-s[3];return this._updateMinMaxDistance(r),n<0?.5*Number.MAX_VALUE:t/n*this._screenSizeFactor}calcCameraDistance(e){return this.calcCameraDistanceToCenter(e)-this.getRenderMbs(e)[3]}calcCameraDistanceToCenter(e){const t=this.getRenderMbs(e),i=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(t,this._camPos);return this._updateMinMaxDistance(i),i}calcAngleDependentLoD(e){const t=this.getRenderMbs(e),i=t[3],n=(Math.abs(t[0]*(t[0]-this._camPos[0])+t[1]*(t[1]-this._camPos[1])+t[2]*(t[2]-this._camPos[2]))/(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.l)(t)+i)/(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(t,this._camPos);return Math.min(1,n)}hasLOD(e){return e.lodMetric!==_I3SNode_js__WEBPACK_IMPORTED_MODULE_14__.LodMetric.None}_getDistancePlanarMode(e,t){const i=e[0]-t[0],s=e[1]-t[1],r=e[2]-t[2],n=i*i+s*s,o=t[3];if(n<=o*o)return Math.abs(r);const a=Math.sqrt(n)-o;return Math.sqrt(r*r+a*a)}_getDistanceGlobeMode(e,t){const m=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.l)(t),l=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.l)(e)-m;(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(this._tmp0,e,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.e)(e,t)/(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.p)(e));const p=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.d)(t,this._tmp0),_=t[3];if(p<=_*_)return Math.abs(l);{const i=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(this._tmp0,t,1/m),a=m,p=_*_/2/a,u=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(this._tmp1,i,a-p),d=e,g=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.b)(this._tmp2,d,u),b=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.b)(this._tmp2,g,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(this._tmp3,i,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.e)(i,g))),v=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.a)(this._tmp2,u,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(this._tmp2,b,_/(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.l)(b)));let x=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(d,v);if(l>=2e5){const e=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.b)(this._tmp1,d,v);let t=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.e)(e,i)/(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.l)(e);t<.08&&(t=1e-4),x/=t}return x}}_getDistance(e,t){return this.engineSR===(0,_geometry_spatialReferenceEllipsoidUtils_js__WEBPACK_IMPORTED_MODULE_6__.getSphericalPCPF)(this.engineSR)?this._getDistanceGlobeMode(e,t):this._getDistancePlanarMode(e,t)}_updateMinMaxDistance(e){e>0?(this.minDistance=Math.min(this.minDistance,e),this.maxDistance=Math.max(this.maxDistance,e)):(this.minDistance=0,this.maxDistance=Math.max(this.maxDistance,-e))}getLodLevel(e){if(e.lodMetric===_I3SNode_js__WEBPACK_IMPORTED_MODULE_14__.LodMetric.None)return 0;if(0===e.childCount)return this.maxLodLevel;if(this._useFrustumCulling&&this._progressiveLoadFactor<1){const t=this._progressiveLoadFactor*this._screenspaceErrorBias,i=this._screenspaceErrorBias;return this.evaluateLODmetric(e,t)?this.evaluateLODmetric(e,i)?2:1:0}return this.evaluateLODmetric(e,this._screenspaceErrorBias)?this.maxLodLevel:0}evaluateLODmetric(e,t){switch(e.lodMetric){case _I3SNode_js__WEBPACK_IMPORTED_MODULE_14__.LodMetric.ScreenSpaceRelative:{const i=this.getRenderMbs(e),s=this._getDistance(this._camPos,i),r=2*s/this._screenSizeFactor,n=s+i[3];return this._updateMinMaxDistance(n),e.maxError*t<=r}case _I3SNode_js__WEBPACK_IMPORTED_MODULE_14__.LodMetric.MaxScreenThreshold:{let i=this._screenSpaceDiameterMbs(e,e.mbs[3]*t);return this._options.angleDependentLoD&&(i*=this.calcAngleDependentLoD(e)),i<e.maxError}case _I3SNode_js__WEBPACK_IMPORTED_MODULE_14__.LodMetric.RemovedFeatureDiameter:return this._screenSpaceDiameterMbs(e,e.maxError)*t<10;case _I3SNode_js__WEBPACK_IMPORTED_MODULE_14__.LodMetric.DistanceRangeFromDefaultCamera:return this.calcCameraDistance(e)>e.maxError*t}return!1}distToPOI(e){const t=this.getRenderMbs(e);return (0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(t,this._poi)-t[3]}distCameraToPOI(){return (0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(this._camPos,this._poi)}}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/I3SViewportQueries.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/i3s/enums.js":
/*!****************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/i3s/enums.js ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"TextureEncoding\": () => (/* binding */ e),\n/* harmony export */   \"TextureUsage\": () => (/* binding */ s)\n/* harmony export */ });\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nvar e,s;!function(e){e[e.KTX2=1]=\"KTX2\",e[e.Basis=2]=\"Basis\",e[e.DDS_S3TC=4]=\"DDS_S3TC\",e[e.PNG=8]=\"PNG\",e[e.JPG=16]=\"JPG\",e[e.KTX_ETC2=32]=\"KTX_ETC2\"}(e||(e={})),function(e){e[e.None=0]=\"None\",e[e.Color=1]=\"Color\",e[e.MetallicRoughness=2]=\"MetallicRoughness\",e[e.Normal=4]=\"Normal\",e[e.Occlusion=8]=\"Occlusion\",e[e.Emissive=16]=\"Emissive\",e[e.AlphaMask=32]=\"AlphaMask\",e[e.ColorTextures=19]=\"ColorTextures\",e[e.GeometryTextures=36]=\"GeometryTextures\",e[e.GeometryTexturesPBR=44]=\"GeometryTexturesPBR\",e[e.AllTextures=37]=\"AllTextures\",e[e.AllTexturesPBR=63]=\"AllTexturesPBR\"}(s||(s={}));\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/i3s/enums.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/layers/support/I3SLayerView.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/layers/support/I3SLayerView.js ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"FadeDirection\": () => (/* binding */ a)\n/* harmony export */ });\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nvar a;!function(a){a[a.FadeIn=0]=\"FadeIn\",a[a.FadeOut=1]=\"FadeOut\"}(a||(a={}));\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/layers/support/I3SLayerView.js?");

/***/ }),

/***/ "./node_modules/@arcgis/core/views/3d/webgl-engine/core/material/RenderTexture.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/3d/webgl-engine/core/material/RenderTexture.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"RenderTexture\": () => (/* binding */ r)\n/* harmony export */ });\n/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../core/maybe.js */ \"./node_modules/@arcgis/core/core/maybe.js\");\n/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../core/promiseUtils.js */ \"./node_modules/@arcgis/core/core/promiseUtils.js\");\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nclass r{constructor(t,r){this._textureRep=t,this.loadPromise=null,this._disposed=!1;const i=this._textureRep.acquire(r);(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__.isPromiseLike)(i)?(i.then((t=>{this._disposed?(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.releaseMaybe)(t):this._textureRef=t})),this.loadPromise=i):this._textureRef=i}dispose(){this._textureRef=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.releaseMaybe)(this._textureRef),this._disposed=!0}get glTexture(){return (0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_0__.isSome)(this._textureRef)?this._textureRef.glTexture:null}}\n\n\n//# sourceURL=webpack://arcgis-starter/./node_modules/@arcgis/core/views/3d/webgl-engine/core/material/RenderTexture.js?");

/***/ })

}]);